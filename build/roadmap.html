<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Interactive Roadmap</title>
  <style>

    /* Base styles */
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0;
      color: #333;
      background-color: #f5f5f5;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }
    
    header {
      background-color: #2c3e50;
      color: white;
      padding: 15px 0;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    
    header h1 {
      margin: 0;
      padding: 0 20px;
      font-size: 24px;
    }
    
    /* Navigation */
    .nav-tabs {
      display: flex;
      background-color: #34495e;
      padding: 0 20px;
    }
    
    .nav-tab {
      padding: 12px 20px;
      color: #ecf0f1;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    
    .nav-tab:hover, .nav-tab.active {
      background-color: #2c3e50;
    }
    
    /* Main content area */
    .main-content {
      background-color: white;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      margin-top: 20px;
      padding: 20px;
    }
    
    /* Tiles for programs, products, etc. */
    .tiles-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    
    .tile {
      background-color: #ecf0f1;
      border-radius: 5px;
      padding: 20px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
      transition: transform 0.2s, box-shadow 0.2s;
      cursor: pointer;
    }
    
    .tile:hover {
      transform: translateY(-5px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    
    .tile-name {
      font-weight: bold;
      font-size: 18px;
      margin-bottom: 10px;
    }
    
    /* Roadmap specific styles */
    .roadmap-container {
      overflow-x: auto;
      margin-top: 20px;
    }
    
    .roadmap {
      min-width: 1000px;
      position: relative;
    }
    
    .roadmap-header {
      display: flex;
      border-bottom: 1px solid #ddd;
      position: sticky;
      top: 0;
      background-color: white;
      z-index: 10;
    }
    
    .roadmap-header-cell {
      flex: 1;
      padding: 10px;
      text-align: center;
      font-weight: bold;
      min-width: 100px;
    }
    
    .roadmap-row {
      display: flex;
      border-bottom: 1px solid #eee;
      position: relative;
      min-height: 60px;
    }
    
    .roadmap-lane-title {
      width: 200px;
      padding: 10px;
      background-color: #f9f9f9;
      font-weight: bold;
      display: flex;
      align-items: center;
      position: sticky;
      left: 0;
      z-index: 5;
    }
    
    .roadmap-lane-content {
      flex: 1;
      position: relative;
      min-height: 40px;
    }
    
    .roadmap-task {
      position: absolute;
      height: 30px;
      top: 5px;
      background-color: #3498db;
      border-radius: 3px;
      color: white;
      padding: 5px;
      box-sizing: border-box;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      cursor: pointer;
      box-shadow: 0 1px 3px rgba(0,0,0,0.2);
    }
    
    .roadmap-task:hover {
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
      z-index: 2;
    }
    
    /* Detail views */
    .detail-view {
      display: none;
      background-color: white;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      margin-top: 20px;
      padding: 20px;
    }
    
    .detail-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
    }
    
    .detail-header h2 {
      margin: 0;
      font-size: 24px;
      font-weight: 600;
      color: #333;
    }
    
    .back-button {
      background-color: #003087;
      color: white;
      border: none;
      border-radius: 6px;
      padding: 10px 20px;
      font-size: 15px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      float: right;
    }
    
    .back-button:hover {
      background-color: #00246b;
      transform: translateY(-2px);
      box-shadow: 0 3px 6px rgba(0,0,0,0.1);
    }
    
    /* Task details */
    .task-detail-section {
      background-color: #f9f9f9;
      border-radius: 5px;
      padding: 15px;
    }
    
    .task-detail-content {
      margin-top: 10px;
    }
    
    .detail-section {
      background-color: #f8f9fa;
      border-radius: 8px;
      padding: 25px;
      margin-bottom: 30px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
      border: 1px solid #e9ecef;
      border-top: 3px solid #6a3093;
    }
    
    .detail-section h3 {
      margin-top: 0;
      margin-bottom: 20px;
      font-size: 22px;
      font-weight: 600;
      color: #333;
    }
    
    .product-metadata {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 15px;
      margin-bottom: 25px;
    }
    
    .product-metadata p {
      margin: 0;
      font-size: 15px;
      line-height: 1.5;
    }
    
    .product-metadata strong {
      font-weight: 600;
      color: #495057;
      margin-right: 8px;
    }
    
    /* Requirements Section */
    .requirements-section {
      margin-bottom: 25px;
    }
    
    .requirements-section h4 {
      margin-top: 0;
      margin-bottom: 15px;
      font-size: 18px;
      font-weight: 600;
      color: #6a3093;
      padding-bottom: 8px;
      border-bottom: 1px solid #e9ecef;
    }
    
    .requirements-list {
      list-style-type: none;
      padding: 0;
      margin: 0;
    }
    
    .requirements-list li {
      margin-bottom: 10px;
      font-size: 15px;
      line-height: 1.5;
      padding-left: 20px;
      position: relative;
    }
    
    .requirements-list li:before {
      content: "•";
      position: absolute;
      left: 0;
      color: #6a3093;
      font-size: 18px;
      line-height: 1;
    }
    
    .requirements-list strong {
      font-weight: 600;
      color: #495057;
      margin-right: 8px;
    }
    
    /* Business Case Section */
    .business-case-section {
      margin-bottom: 0;
    }
    
    .business-case-section h4 {
      margin-top: 0;
      margin-bottom: 15px;
      font-size: 18px;
      font-weight: 600;
      color: #6a3093;
      padding-bottom: 8px;
      border-bottom: 1px solid #e9ecef;
    }
    
    .business-case-list {
      list-style-type: none;
      padding: 0;
      margin: 0;
    }
    
    .business-case-list li {
      margin-bottom: 10px;
      font-size: 15px;
      line-height: 1.5;
      padding-left: 20px;
      position: relative;
    }
    
    .business-case-list li:before {
      content: "•";
      position: absolute;
      left: 0;
      color: #6a3093;
      font-size: 18px;
      line-height: 1;
    }
    
    .business-case-list strong {
      font-weight: 600;
      color: #495057;
      margin-right: 8px;
    }
    
    /* Related Programs Section */
    .related-section {
      margin-top: 30px;
      margin-bottom: 30px;
    }
    
    .related-section h3 {
      margin-top: 0;
      margin-bottom: 20px;
      font-size: 20px;
      font-weight: 600;
      color: #333;
    }
    
    /* Status indicators */
    .status-indicator {
      display: inline-block;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      margin-right: 5px;
    }
    
    .status-complete {
      background-color: #2ecc71;
    }
    
    .status-in-progress {
      background-color: #f39c12;
    }
    
    .status-planned {
      background-color: #3498db;
    }
    
    /* Related section styles */
    .related-section {
      margin-top: 30px;
    }
    
    .related-section h3 {
      margin-bottom: 15px;
      border-bottom: 1px solid #eee;
      padding-bottom: 10px;
    }
    
    .year-label {
      font-size: 10px;
      color: #7f8c8d;
    }
    
    /* Responsive design improvements */
    @media (max-width: 768px) {
      .tiles-container {
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      }
      
      .roadmap-lane-title {
        width: 150px;
      }
    }
    
    /* Print styles */
    @media print {
      body {
        background-color: white;
      }
      
      .nav-tabs, .back-button {
        display: none;
      }
      
      .container {
        max-width: 100%;
        margin: 0;
        padding: 0;
      }
      
      .roadmap-container {
        overflow: visible;
      }
    }
    
    /* Tooltip styles */
    .tooltip {
      position: relative;
      display: inline-block;
    }
    
    .tooltip .tooltip-text {
      visibility: hidden;
      width: 200px;
      background-color: #555;
      color: #fff;
      text-align: center;
      border-radius: 6px;
      padding: 5px;
      position: absolute;
      z-index: 1;
      bottom: 125%;
      left: 50%;
      margin-left: -100px;
      opacity: 0;
      transition: opacity 0.3s;
    }
    
    .tooltip:hover .tooltip-text {
      visibility: visible;
      opacity: 1;
    }
    
    /* Quad Box Styles */
    .specialized-quad-box {
      display: grid;
      grid-template-columns: 1fr 1fr;
      grid-template-rows: 1fr 1fr;
      gap: 20px;
      margin-top: 25px;
    }
    
    .quad-section {
      background-color: #f8f9fa;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
      border: 1px solid #e9ecef;
      overflow: auto;
      max-height: 400px;
    }
    
    .quad-section h4 {
      margin-top: 0;
      margin-bottom: 15px;
      font-size: 18px;
      font-weight: 600;
      color: #333;
      padding-bottom: 10px;
      border-bottom: 1px solid #e9ecef;
    }
    
    /* Material Systems Section - Match MRL slider color */
    .material-section {
      border-top: 3px solid #007bff;
    }
    
    .material-header h5 {
      margin-top: 0;
      margin-bottom: 15px;
      font-size: 16px;
      color: #007bff;
    }
    
    .material-details p {
      margin: 8px 0;
      font-size: 14px;
      line-height: 1.5;
    }
    
    .material-details strong {
      font-weight: 600;
      color: #495057;
    }
    
    .view-details-button-container {
      margin-top: 20px;
      text-align: right;
    }
    
    .view-full-details {
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 6px;
      padding: 8px 16px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .view-full-details:hover {
      background-color: #0056b3;
      transform: translateY(-2px);
      box-shadow: 0 3px 6px rgba(0,0,0,0.1);
    }
    
    /* Manufacturing Section - Unique color (magenta) */
    .manufacturing-section {
      border-top: 3px solid #e83e8c;
    }
    
    .manufacturing-section h5 {
      margin-top: 15px;
      margin-bottom: 10px;
      font-size: 15px;
      color: #e83e8c;
    }
    
    .manufacturing-section ul {
      list-style-type: none;
      padding: 0;
      margin: 0;
    }
    
    .manufacturing-section li {
      margin-bottom: 6px;
      font-size: 14px;
    }
    
    .supplier-link {
      color: #e83e8c;
      text-decoration: none;
      transition: color 0.2s ease;
    }
    
    .supplier-link:hover {
      color: #d6246f;
      text-decoration: underline;
    }
    
    /* Design Section */
    .design-section {
      border-top: 3px solid #2e8b57;
    }
    
    .design-section h5 {
      margin-top: 15px;
      margin-bottom: 10px;
      font-size: 15px;
      color: #2e8b57;
    }
    
    .design-section ul {
      list-style-type: none;
      padding: 0;
      margin: 0;
    }
    
    .design-section li {
      margin-bottom: 6px;
      font-size: 14px;
    }
    
    /* Quality Section */
    .quality-section {
      border-top: 3px solid #fd7e14;
    }
    
    .quality-section h5 {
      margin-top: 15px;
      margin-bottom: 10px;
      font-size: 15px;
      color: #fd7e14;
    }
    
    .quality-section ul {
      list-style-type: none;
      padding: 0;
      margin: 0;
    }
    
    .quality-section li {
      margin-bottom: 6px;
      font-size: 14px;
    }
    
    /* Post Processing Lists */
    .post-processing-list {
      list-style-type: none;
      padding: 0;
      margin: 5px 0 0 0;
    }
    
    .post-processing-list li {
      margin-bottom: 5px;
      font-size: 14px;
      padding-left: 15px;
      position: relative;
    }
    
    .post-processing-list li:before {
      content: "•";
      position: absolute;
      left: 0;
      color: #6c757d;
    }
    
    /* Consistent button styling */
    .view-details-button {
      background-color: #3498db;
      color: white;
      border: none;
      border-radius: 4px;
      padding: 8px 16px;
      cursor: pointer;
      font-weight: normal;
      font-size: 14px;
      transition: background-color 0.2s;
    }
    
    .view-details-button:hover {
      background-color: #2980b9;
    }
    
    /* Consistent layout for the product details page */
    .readiness-bars-container {
      display: flex;
      justify-content: center;
      margin-bottom: 20px;
    }
    
    .readiness-bars {
      width: 70%;
      max-width: 800px;
    }
    
    /* Make supplier tiles match the reference image */
    .supplier-tile {
      background-color: #f0f8ff;
      border: 1px solid #d0e3f7;
      border-radius: 4px;
      padding: 8px 12px;
      margin-bottom: 5px;
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 14px;
    }
    
    .supplier-tile:hover {
      background-color: #d9edf7;
      border-color: #85c1e9;
    }
    
    /* Material Tiles Styles */
    .material-tiles {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 15px;
    }
    
    .material-tile {
      background-color: #f8f9fa;
      border: 1px solid #ddd;
      border-radius: 4px;
      padding: 6px 12px;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .material-tile:hover {
      background-color: #e9ecef;
      border-color: #adb5bd;
    }
    
    .material-tile.selected {
      background-color: #e3f2fd;
      border-color: #3498db;
      font-weight: bold;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .material-details {
      margin-bottom: 15px;
    }
    
    .material-details div {
      margin-bottom: 8px;
    }
    
    /* Add these styles for the enhanced product details page */
    .wide-quad-box {
      max-width: 1200px;
      width: 90%;
      margin: 0 auto;
    }
    
    .supplier-tiles {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin: 10px 0;
    }
    
    .supplier-tile {
      background-color: #f0f8ff; /* Light blue */
      border: 1px solid #b8d8f8;
      border-radius: 4px;
      padding: 8px 12px;
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 14px;
      color: #2c3e50;
    }
    
    .supplier-tile:hover {
      background-color: #d9edf7;
      border-color: #85c1e9;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    /* Update the button container style */
    .view-details-button-container {
      margin-top: 15px;
      text-align: center;
    }
    
    .view-details-button-container.left-aligned {
      text-align: left;
    }
    
    .view-details-button {
      background-color: #3498db;
      color: white;
      border: none;
      border-radius: 4px;
      padding: 8px 16px;
      cursor: pointer;
      font-weight: bold;
      transition: background-color 0.2s;
    }
    
    .view-details-button:hover {
      background-color: #2980b9;
    }
    
    /* Make the specialized quad box responsive but prioritize desktop view */
    @media (min-width: 1200px) {
      .specialized-quad-box {
        gap: 25px; /* Larger gap on desktop */
      }
      
      .quad-section {
        padding: 20px; /* More padding on desktop */
      }
    }
    
    /* Program Details Styles */
    .program-details {
      padding: 20px;
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
    }
    
    .program-details h1 {
      color: #000;
      font-size: 28px;
      margin-bottom: 20px;
      border-bottom: none;
    }
    
    .program-details-info {
      margin-bottom: 30px;
    }
    
    .program-details-info p {
      margin: 8px 0;
      font-size: 16px;
    }
    
    .products-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .product-card {
      border: 1px solid #ccc;
      border-radius: 4px;
      padding: 15px;
      width: 100%;
      max-width: 450px;
      background-color: #fff;
      cursor: pointer;
      transition: box-shadow 0.3s ease;
    }
    
    .product-card:hover {
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    
    .product-card h3 {
      margin-top: 0;
      color: #003087;
      font-size: 18px;
      margin-bottom: 15px;
    }
    
    .product-status p {
      margin: 5px 0;
      font-size: 14px;
    }
    
    .back-button {
      background-color: #003087;
      color: white;
      border: none;
      padding: 8px 20px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
    }
    
    .back-button:hover {
      background-color: #00246b;
    }
    
    /* Business Case Styles */
    .business-case-section {
      margin-top: 15px;
    }
    
    .business-case-section h4 {
      margin-top: 0;
      margin-bottom: 10px;
      font-weight: 600;
      font-size: 16px;
    }
    
    .business-case-list {
      list-style-type: none;
      padding: 0;
      margin: 0;
    }
    
    .business-case-list li {
      margin-bottom: 8px;
    }
    
    .business-case-list li strong {
      font-weight: 600;
      margin-right: 5px;
    }
    
    /* Material Systems Styles in Quad Box */
    .material-systems-list {
      list-style-type: none;
      padding: 0;
      margin: 0;
    }
    
    .material-system-item {
      margin-bottom: 20px;
      border-bottom: 1px solid #eee;
      padding-bottom: 15px;
    }
    
    .material-system-item:last-child {
      border-bottom: none;
      margin-bottom: 0;
    }
    
    .material-header {
      margin-bottom: 8px;
    }
    
    .material-link {
      color: #003087;
      font-weight: 600;
      text-decoration: none;
      font-size: 16px;
    }
    
    .material-link:hover {
      text-decoration: underline;
    }
    
    .material-details p {
      margin: 5px 0;
      font-size: 14px;
    }
    
    .material-post-processing, .material-machines {
      margin-top: 8px;
    }
    
    .post-processing-list, .machines-list {
      margin: 5px 0 0 15px;
      padding: 0;
      font-size: 13px;
    }
    
    .post-processing-list li, .machines-list li {
      margin-bottom: 3px;
    }
    
    /* Material System Filter Styles */
    .material-system-filters {
      margin-bottom: 25px;
      padding: 20px;
      background-color: #f8f9fa;
      border-radius: 8px;
      border: 1px solid #e9ecef;
    }
    
    .filter-label {
      font-weight: 600;
      margin-bottom: 15px;
      color: #333;
      font-size: 18px;
    }
    
    .filter-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
    }
    
    .material-filter-btn {
      background-color: #f0f0f0;
      border: none;
      border-radius: 6px;
      padding: 12px 20px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 500;
      transition: all 0.2s ease;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    
    .material-filter-btn:hover {
      background-color: #e0e0e0;
      transform: translateY(-2px);
      box-shadow: 0 3px 6px rgba(0,0,0,0.1);
    }
    
    .material-filter-btn.active {
      background-color: #0056b3;
      color: white;
      box-shadow: 0 3px 6px rgba(0,0,0,0.2);
    }
    
    /* Material System Details Styles */
    .material-system-details {
      margin-bottom: 15px;
    }
    
    .material-system-details h5 {
      margin-top: 0;
      margin-bottom: 10px;
      color: #003087;
      font-size: 16px;
    }
    
    .manufacturing-for-material, .quality-for-material {
      margin-bottom: 15px;
    }
    
    .qualified-machines, .post-processing, .relevant-suppliers,
    .standard-ndt, .special-ndt, .part-acceptance,
    .product-machines, .product-suppliers {
      margin-bottom: 15px;
    }
    
    .qualified-machines h5, .post-processing h5, .relevant-suppliers h5,
    .standard-ndt h5, .special-ndt h5, .part-acceptance h5,
    .product-machines h5, .product-suppliers h5 {
      margin-top: 0;
      margin-bottom: 8px;
      font-size: 15px;
      color: #495057;
    }
    
    .machines-list, .post-processing-list, .suppliers-list, .ndt-list {
      list-style-type: none;
      padding: 0;
      margin: 0 0 0 5px;
    }
    
    .machines-list li, .post-processing-list li, .suppliers-list li, .ndt-list li {
      margin-bottom: 5px;
      font-size: 14px;
    }
    
    .view-details-button-container {
      margin-top: 15px;
    }
    
    .material-details-btn {
      background-color: #003087;
      color: white;
      border: none;
      border-radius: 4px;
      padding: 6px 12px;
      font-size: 14px;
      cursor: pointer;
    }
    
    .material-details-btn:hover {
      background-color: #00246b;
    }
    
    /* Product Development Progress Styles */
    .product-development-progress {
      margin-bottom: 30px;
      padding: 20px 25px;
      background-color: #f8f9fa;
      border-radius: 8px;
      border: 1px solid #e9ecef;
      width: 80%;
      margin-left: auto;
      margin-right: auto;
    }
    
    .progress-section {
      margin-bottom: 10px;
      display: flex;
      align-items: center;
    }
    
    .progress-section:last-child {
      margin-bottom: 0;
    }
    
    .progress-section h4 {
      margin: 0;
      font-size: 18px;
      color: #333;
      font-weight: 600;
      width: 70px;
      flex-shrink: 0;
      text-align: right;
      padding-right: 15px;
    }
    
    .progress-container {
      width: 100%;
      position: relative;
    }
    
    .progress-bar-wrapper {
      height: 28px;
      background-color: #e9ecef;
      border-radius: 8px;
      overflow: hidden;
      margin-bottom: 5px;
      box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
      position: relative;
    }
    
    .progress-bar {
      height: 100%;
      border-radius: 8px;
      transition: width 0.5s ease;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: flex-end;
      padding-right: 15px;
    }
    
    .trl-progress {
      background: linear-gradient(90deg, #5d4cb6, #7e6fd3);
    }
    
    .mrl-progress {
      background: linear-gradient(90deg, #007bff, #00b8d4);
    }
    
    .progress-current {
      color: white;
      font-weight: 600;
      font-size: 16px;
      text-shadow: 0 1px 2px rgba(0,0,0,0.3);
      white-space: nowrap;
    }
    
    .progress-labels {
      display: flex;
      justify-content: space-between;
      font-size: 14px;
      color: #6c757d;
    }
    
    .progress-min, .progress-max {
      color: #6c757d;
    }
  

    /* Roadmap Container Styles */
    .roadmap-container {
      margin-top: 20px;
      border: 1px solid #ddd;
      border-radius: 8px;
      overflow: hidden;
      background-color: #fff;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    
    /* Timeline Controls */
    .roadmap-timeline-controls {
      padding: 10px;
      background-color: #f5f5f5;
      border-bottom: 1px solid #ddd;
      display: flex;
      align-items: center;
    }
    
    .start-date-picker {
      margin-left: 10px;
      padding: 5px;
      border-radius: 4px;
      border: 1px solid #ccc;
    }
    
    /* Timeline Styles */
    .roadmap-timeline {
      position: relative;
      overflow-x: auto;
    }
    
    /* Header Styles */
    .roadmap-header {
      display: flex;
      border-bottom: 1px solid #ddd;
      background-color: #f9f9f9;
    }
    
    .roadmap-header-lane {
      flex: 0 0 150px;
      padding: 10px;
      font-weight: bold;
      border-right: 1px solid #ddd;
    }
    
    .roadmap-header-quarter {
      flex: 0 0 100px;
      padding: 10px;
      text-align: center;
      font-weight: bold;
      border-right: 1px solid #eee;
    }
    
    /* Row Styles */
    .roadmap-row {
      display: flex;
      border-bottom: 1px solid #ddd;
      min-height: 60px;
    }
    
    .roadmap-lane-title {
      flex: 0 0 150px;
      padding: 10px;
      font-weight: bold;
      background-color: #f5f5f5;
      border-right: 1px solid #ddd;
      display: flex;
      align-items: center;
    }
    
    .roadmap-lane-content {
      flex: 1;
      position: relative;
      min-width: 1200px;
    }
    
    /* Task Styles */
    .roadmap-task {
      position: absolute;
      height: 25px;
      border-radius: 4px;
      padding: 4px;
      overflow: hidden;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      border: 1px solid rgba(255,255,255,0.2);
      cursor: pointer;
      transition: transform 0.1s, box-shadow 0.1s;
    }
    
    .roadmap-task:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
      z-index: 10;
    }
    
    .roadmap-task.complete {
      background-color: #4CAF50;
      border-color: #81C784;
    }
    
    .roadmap-task.in-progress {
      background-color: #42A5F5;
      border-color: #90CAF9;
    }
    
    .roadmap-task.in-progress.funding-sector-irad {
      background-color: #AB47BC;
      border-color: #CE93D8;
    }
    
    .roadmap-task.in-progress.funding-division-irad {
      background-color: #FFA726;
      border-color: #FFCC80;
    }
    
    .roadmap-task.in-progress.funding-crad {
      background-color: #EC407A;
      border-color: #F48FB1;
    }
    
    .roadmap-task.planned {
      background-color: #BDBDBD;
      border-color: #E0E0E0;
      color: #212121;
    }
    
    .task-label {
      font-size: 12px;
      font-weight: bold;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
      color: white;
    }
    
    .roadmap-task.planned .task-label {
      color: #212121;
      text-shadow: none;
    }
    
    /* Program and Milestone Styles */
    .milestone-row {
      background-color: #f0f8ff;
      border-bottom: 2px solid #00269A;
    }
    
    .programs-row {
      background-color: #f0f0ff;
      border-bottom: 2px solid #00269A;
    }
    
    .roadmap-milestone {
      position: absolute;
      top: 5px;
      transform: translateX(-50%);
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 20px;
    }
    
    .milestone-marker {
      width: 20px;
      height: 20px;
      background-color: #4a89ff;
      border-radius: 50%;
      border: 2px solid white;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    
    .milestone-label {
      margin-top: 5px;
      font-size: 12px;
      font-weight: bold;
      white-space: nowrap;
      transform: rotate(-45deg);
      transform-origin: top left;
    }
    
    .program-marker {
      position: absolute;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    
    .program-marker-point {
      width: 16px;
      height: 16px;
      background-color: #ff5722;
      border-radius: 50%;
      border: 2px solid white;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    
    .program-marker-label {
      margin-top: 5px;
      font-size: 12px;
      font-weight: bold;
      white-space: nowrap;
    }
    
    /* Roadmap Key Styles */
    .roadmap-key {
      margin-top: 20px;
      padding: 15px;
      background-color: #f9f9f9;
      border-radius: 8px;
      border: 1px solid #ddd;
    }
    
    .roadmap-key h4 {
      margin-top: 0;
      margin-bottom: 10px;
    }
    
    .key-items {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
    }
    
    .key-item {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .key-color {
      width: 20px;
      height: 20px;
      border-radius: 4px;
    }
    
    .key-color.planned {
      background-color: #BDBDBD;
      border: 1px solid #E0E0E0;
    }
    
    .key-color.in-progress {
      background-color: #42A5F5;
      border: 1px solid #90CAF9;
    }
    
    .key-color.in-progress.funding-sector-irad {
      background-color: #AB47BC;
      border: 1px solid #CE93D8;
    }
    
    .key-color.in-progress.funding-division-irad {
      background-color: #FFA726;
      border: 1px solid #FFCC80;
    }
    
    .key-color.in-progress.funding-crad {
      background-color: #EC407A;
      border: 1px solid #F48FB1;
    }
    
    .key-color.complete {
      background-color: #4CAF50;
      border: 1px solid #81C784;
    }
    
    .key-label {
      font-size: 14px;
      color: #333;
    }
    
    .roadmap-source-note {
      margin-top: 10px;
      font-size: 12px;
      font-style: italic;
      color: #666;
    }
  
  </style>
</head>
<body>
  <!-- Data debugging -->
  <script>
    console.log('Data embedded in page');
  </script>
  
  <!-- Embed the data as JSON -->
  
    <script id="roadmap-data" type="application/json">
      {"programs":[{"id":"PRG1","name":"Satellite Systems","division":"S","customerName":"N/A","missionClass":"Class A","needDate":"2025-06-30","closeDate":"2025-08-30"},{"id":"PRG2","name":"Missile Defense","division":"T","customerName":"N/A","missionClass":"Class D","needDate":"2025-06-30"},{"id":"PRG3","name":"Launch Vehicles","division":"S","customerName":"Unknown","missionClass":"Class A","needDate":"2025-06-30","closeDate":""},{"id":"PRG4","name":"Space Exploration","division":"L","customerName":"N/A","missionClass":"Class C","needDate":"2025-06-30"},{"id":"PRG5","name":"Communications","division":"P","customerName":"N/A","missionClass":"Class B","needDate":"2025-06-30"}],"products":[{"id":"P1","name":"SatCom Terminal Housing","trl":7,"requirements":{"mechanical":"Withstand 10G acceleration, -40°C to +85°C temperature range","electrical":"EMI shielding, grounding requirements","environmental":"Salt fog resistance, humidity cycling"},"programs":["PRG1","PRG5"],"materialSystems":["MS1","MS3"],"postProcessing":["Surface finishing","Machining of critical interfaces","Anodizing"],"postProcessingSuppliers":[{"process":"Surface finishing","supplier":"SUP4"},{"process":"Machining of critical interfaces","supplier":"SUP2"},{"process":"Anodizing","supplier":"SUP5"}],"designTools":["CADPro Advanced","SimulateX Thermal","FEA Structural Analysis"],"documentation":["MIL-STD-810 Test Reports","Material Certification","Process Qualification Records","First Article Inspection Report"],"relevantMachines":["EOS M290","Concept Laser M2"],"relevantSuppliers":["SUP1","SUP3"],"specialNDT":["CT Scanning for internal defects","Dye penetrant inspection","X-ray inspection of critical features"],"partAcceptance":["Visual inspection per AWS D17.1","Dimensional verification","Functional testing","Surface roughness measurement"],"productSupplyChain":"Direct sourcing from approved vendors with secondary source qualification.","roadmap":[{"task":"Initial Design","start":"2025-01-01","end":"2025-03-31","status":"Complete","lane":"Design","fundingType":"Division IRAD"},{"task":"Prototype Build","start":"2025-04-01","end":"2025-06-30","status":"In Progress","lane":"Manufacturing","fundingType":"Sector IRAD"},{"task":"Material Qualification","start":"2025-02-15","end":"2025-05-15","status":"In Progress","lane":"M&P","fundingType":"CRAD"},{"task":"First Article Inspection","start":"2025-07-01","end":"2025-07-31","status":"Planned","lane":"Quality"}],"milestones":[{"name":"PDR","date":"2025-02-15","description":"Preliminary Design Review"},{"name":"CDR","date":"2025-04-30","description":"Critical Design Review"},{"name":"TRR","date":"2025-07-15","description":"Test Readiness Review"}],"businessCase":{"costSavings":"Reduces manufacturing costs by 35% compared to traditional methods due to reduced part count and elimination of complex machining operations.","scheduleSavings":"Shortens procurement lead time from 16 weeks to 4 weeks, enabling faster system integration and testing.","performanceGains":"15% weight reduction compared to conventional design, improving overall system performance. Enhanced thermal management through optimized internal geometry."}},{"id":"P2","name":"Weather Satellite Antenna Mount","trl":6,"requirements":{"mechanical":"High stiffness, low mass, survive launch loads","thermal":"Low CTE, thermal stability in space environment","environmental":"Vacuum compatibility, radiation resistance"},"programs":["PRG1"],"materialSystems":["MS2"],"postProcessing":["Precision machining","Passivation","Surface treatment"],"designTools":["OrbitSim","ThermalAnalyzer","Topology Optimization Suite"],"documentation":["NASA-STD-6016 Compliance","Thermal Cycling Test Results","Structural Analysis Report","Material Traceability Documentation"],"relevantMachines":["SLM 280","Arcam Q20+"],"relevantSuppliers":["SUP2"],"specialNDT":["Ultrasonic testing","Radiographic inspection","Thermal imaging"],"partAcceptance":["Thermal cycling test","Vibration test","Dimensional inspection","Surface finish verification"],"productSupplyChain":"Specialized logistics for space-grade components with full traceability.","roadmap":[{"task":"Concept Development","start":"2025-01-15","end":"2025-03-15","status":"Complete","lane":"Design","fundingType":"Division IRAD"},{"task":"Component Testing","start":"2025-04-01","end":"2025-05-31","status":"Planned","lane":"Quality"},{"task":"Process Parameter Development","start":"2025-03-01","end":"2025-04-30","status":"In Progress","lane":"M&P","fundingType":"Sector IRAD"},{"task":"Prototype Manufacturing","start":"2024-11-01","end":"2025-02-28","status":"In Progress","lane":"Manufacturing","fundingType":"CRAD"}],"milestones":[{"name":"Design Freeze","date":"2025-03-15","description":"Final design approval"},{"name":"Qualification Complete","date":"2025-06-30","description":"All qualification testing completed"}],"businessCase":{"costSavings":"Reduces manufacturing costs by 35% compared to traditional methods due to reduced part count and elimination of complex machining operations.","scheduleSavings":"Shortens procurement lead time from 16 weeks to 4 weeks, enabling faster system integration and testing.","performanceGains":"15% weight reduction compared to conventional design, improving overall system performance. Enhanced thermal management through optimized internal geometry."}},{"id":"P3","name":"Interceptor Missile Nozzle","trl":5,"requirements":{"mechanical":"High temperature strength, erosion resistance","thermal":"Withstand 1200°C operating temperature","performance":"Specific thrust profile, weight constraints"},"programs":["PRG2"],"materialSystems":["MS2"],"postProcessing":["EDM wire cutting","Precision grinding","Polishing of flow surfaces"],"designTools":["BallisticsCalc","WindTunnel","Computational Fluid Dynamics"],"documentation":["Defense Manual","Safety Protocol","Material Property Database","Process Qualification Documentation"],"relevantMachines":["EOS M400-4","AMCM M4K"],"relevantSuppliers":["SUP2"],"specialNDT":["Neutron radiography","Acoustic emission testing","High-resolution CT scanning"],"partAcceptance":["Impact test","Pressure test","Flow testing","Metallurgical evaluation"],"productSupplyChain":"Integrated supply chain with defense contractors and ITAR compliance.","roadmap":[{"task":"Design Optimization","start":"2025-03-01","end":"2025-05-31","status":"In Progress","lane":"Design"},{"task":"Field Testing","start":"2025-06-01","end":"2025-08-31","status":"Planned","lane":"Quality"},{"task":"Manufacturing Process Development","start":"2025-04-15","end":"2025-07-15","status":"Planned","lane":"Manufacturing"}],"businessCase":{"costSavings":"Reduces manufacturing costs by 35% compared to traditional methods due to reduced part count and elimination of complex machining operations.","scheduleSavings":"Shortens procurement lead time from 16 weeks to 4 weeks, enabling faster system integration and testing.","performanceGains":"15% weight reduction compared to conventional design, improving overall system performance. Enhanced thermal management through optimized internal geometry."}},{"id":"P4","name":"Reusable Rocket Injector Plate","trl":8,"requirements":{"mechanical":"Fatigue resistance, high cycle life","thermal":"Thermal shock resistance, high heat flux","fluid":"Complex internal channels, specific flow characteristics"},"programs":["PRG3"],"materialSystems":["MS1"],"postProcessing":["CNC finishing of mating surfaces","Abrasive flow machining of internal channels","Surface treatment"],"designTools":["PropulsionSim","TrajectoryCalc","Generative Design Software"],"documentation":["Launch Manual","Maintenance Guide","Design History File","Process Validation Reports"],"relevantMachines":["Velo3D Sapphire","GE Concept Laser X Line"],"relevantSuppliers":["SUP1"],"specialNDT":["Helium leak testing","Flow path verification","Pressure drop testing"],"partAcceptance":["Stress test","Safety test","Flow performance verification","Thermal cycling"],"productSupplyChain":"Optimized for rapid turnaround with digital thread implementation.","roadmap":[{"task":"Engine Testing","start":"2025-02-01","end":"2025-04-30","status":"Complete","lane":"Quality"},{"task":"Flight Simulation","start":"2025-05-01","end":"2025-07-31","status":"Planned","lane":"Design"},{"task":"Material Property Database Development","start":"2025-03-15","end":"2025-06-15","status":"In Progress","lane":"M&P"}],"businessCase":{"costSavings":"Reduces manufacturing costs by 35% compared to traditional methods due to reduced part count and elimination of complex machining operations.","scheduleSavings":"Shortens procurement lead time from 16 weeks to 4 weeks, enabling faster system integration and testing.","performanceGains":"15% weight reduction compared to conventional design, improving overall system performance. Enhanced thermal management through optimized internal geometry."}},{"id":"P5","name":"Lunar Rover Wheel Structure","trl":4,"requirements":{"mechanical":"Low mass, high strength-to-weight ratio","environmental":"Lunar dust resistance, extreme temperature cycling","operational":"Energy absorption, traction on regolith"},"programs":["PRG4"],"materialSystems":["MS3"],"postProcessing":["Shot peening","Selective machining","Surface texturing"],"designTools":["RoverSim","3DModeler","Lattice Structure Generator"],"documentation":["Operational Manual","Spec Sheet","Qualification Test Reports","Failure Mode and Effects Analysis"],"relevantMachines":["EOS M290","SLM 280"],"relevantSuppliers":["SUP3"],"specialNDT":["Micro-CT for lattice inspection","Laser profilometry","Residual stress measurement"],"partAcceptance":["Performance test","Durability test","Thermal vacuum testing","Regolith interaction testing"],"productSupplyChain":"Customized for extraterrestrial components with redundant sourcing.","roadmap":[{"task":"Mobility Analysis","start":"2025-01-01","end":"2025-02-28","status":"Complete","lane":"Design"},{"task":"Terrain Testing","start":"2025-03-01","end":"2025-05-31","status":"In Progress","lane":"Quality"},{"task":"Lattice Structure Optimization","start":"2025-02-15","end":"2025-04-30","status":"In Progress","lane":"Design"},{"task":"Surface Treatment Development","start":"2025-04-01","end":"2025-06-30","status":"Planned","lane":"M&P"}],"businessCase":{"costSavings":"Reduces manufacturing costs by 35% compared to traditional methods due to reduced part count and elimination of complex machining operations.","scheduleSavings":"Shortens procurement lead time from 16 weeks to 4 weeks, enabling faster system integration and testing.","performanceGains":"15% weight reduction compared to conventional design, improving overall system performance. Enhanced thermal management through optimized internal geometry."}}],"materialSystems":[{"id":"MS1","name":"LPBF Ti-6Al-4V","process":"Laser Powder Bed Fusion","material":"Ti-6Al-4V","qualification":"Qualified","qualificationClass":"Class 1","statisticalBasis":"S","mrl":8,"supplyChain":"Robust and established.","properties":[],"processingParameters":[],"heatTreatment":["HIP"],"postProcessing":["Stress relief heat treatment","Hot Isostatic Pressing (HIP)","Surface finishing"],"qualifiedMachines":["EOS M290","Concept Laser M2","SLM 280"],"relatedOpportunities":["OPP3"],"roadmap":[{"task":"Material Certification","start":"2025-01-01","end":"2025-02-28","status":"Complete","fundingType":"Division IRAD"},{"task":"Batch Testing","start":"2025-03-01","end":"2025-04-30","status":"Planned","fundingType":"Sector IRAD"},{"task":"Test","start":"2025-02-03","end":"2025-03-26","status":"Complete","fundingType":"Division IRAD"}],"milestones":[{"name":"Cert Approved","date":"2025-02-28","description":"Certification received from testing agency."}],"standardNDT":["Visual inspection","Dimensional inspection","Surface roughness measurement"]},{"id":"MS2","name":"LPBF Inconel 718","process":"Laser Powder Bed Fusion","material":"Inconel 718","mrl":3,"qualification":"Pending","qualificationClass":"Class 2","statisticalBasis":"D","supplyChain":"Moderate reliability.","properties":{"tensileStrength":"1250-1400 MPa","yieldStrength":"1000-1150 MPa","elongation":"12-15%","density":"8.19 g/cm³"},"processingParameters":{"laserPower":"285-350W","scanSpeed":"960-1000 mm/s","layerThickness":"40 μm","hatchSpacing":"0.11 mm"},"heatTreatment":{"process":"Solution annealing and double aging","temperature":"980°C for 1 hour, then 720°C for 8 hours, then 620°C for 8 hours","cooling":"Furnace cool"},"postProcessing":["Solution annealing","Double aging","Machining of critical features"],"qualifiedMachines":["EOS M400-4","Concept Laser X LINE 2000R"],"relatedOpportunities":["OPP4"],"roadmap":[{"task":"Preliminary Tests","start":"2025-02-01","end":"2025-03-31","status":"In Progress","fundingType":"CRAD"}],"milestones":[{"name":"Initial Results","date":"2025-03-31","description":"First round of tests completed."}],"standardNDT":["Visual inspection","Dimensional inspection","Radiographic testing"]},{"id":"MS3","name":"LPBF AlSi10Mg","process":"Laser Powder Bed Fusion","material":"AlSi10Mg","mrl":5,"qualification":"Qualified","qualificationClass":"Class 3","statisticalBasis":"C","supplyChain":"Strong and cost-effective.","properties":{"tensileStrength":"330-360 MPa","yieldStrength":"220-240 MPa","elongation":"3-5%","density":"2.67 g/cm³"},"processingParameters":{"laserPower":"350-370W","scanSpeed":"1150-1250 mm/s","layerThickness":"30 μm","hatchSpacing":"0.13 mm"},"postProcessing":["Stress relief","T6 heat treatment","Surface finishing"],"qualifiedMachines":["EOS M290","SLM 280","Renishaw AM400"],"relatedOpportunities":[],"roadmap":[{"task":"Process Validation","start":"2025-01-15","end":"2025-03-15","status":"Complete","fundingType":"Division IRAD"}],"milestones":[],"standardNDT":["Visual inspection","Dimensional inspection","Dye penetrant inspection"]},{"id":"MS4","name":"EBM Ti-6Al-4V","process":"Electron Beam Melting","material":"Ti-6Al-4V","qualification":"In Progress","qualificationClass":"Class 4","statisticalBasis":"None","supplyChain":"Developing with key suppliers.","properties":{"tensileStrength":"930-1020 MPa","yieldStrength":"860-930 MPa","elongation":"10-14%","density":"4.43 g/cm³"},"processingParameters":{"beamPower":"600-1000W","scanSpeed":"4500-5500 mm/s","layerThickness":"50-70 μm","preheatingTemperature":"700-750°C"},"postProcessing":["HIP treatment","Chemical etching","Machining"],"qualifiedMachines":["Arcam Q20","Arcam A2X"],"relatedOpportunities":["OPP3"],"roadmap":[{"task":"Parameter Optimization","start":"2025-02-01","end":"2025-05-31","status":"In Progress","fundingType":"Sector IRAD"},{"task":"Mechanical Testing","start":"2025-06-01","end":"2025-08-31","status":"Planned","fundingType":"Division IRAD"}],"milestones":[{"name":"Optimization Complete","date":"2025-05-31","description":"Process parameters finalized for production."}],"standardNDT":["Visual inspection","Dimensional inspection","CT scanning"]},{"id":"MS5","name":"DED 316L Stainless Steel","process":"Directed Energy Deposition","material":"316L Stainless Steel","qualification":"Qualified","qualificationClass":"Class 5","statisticalBasis":"S","supplyChain":"Well-established with multiple sources.","properties":{"tensileStrength":"520-620 MPa","yieldStrength":"280-350 MPa","elongation":"30-40%","density":"7.99 g/cm³"},"processingParameters":{"laserPower":"800-1200W","feedRate":"8-15 g/min","scanSpeed":"600-1000 mm/min","layerHeight":"0.8-1.2 mm"},"postProcessing":["Solution annealing","Machining","Polishing"],"qualifiedMachines":["BeAM Modulo 400","DMG MORI LASERTEC 65 3D","Optomec LENS 850-R"],"relatedOpportunities":[],"roadmap":[{"task":"Large Component Validation","start":"2025-03-01","end":"2025-06-30","status":"Planned","fundingType":"Division IRAD"}],"milestones":[{"name":"Production Readiness","date":"2025-06-30","description":"Validated for production components."}],"standardNDT":["Visual inspection","Dimensional inspection","Ultrasonic testing"]}],"suppliers":[{"id":"SUP1","name":"AeroSupplies Inc.","materials":["MS1","MS3"],"additionalCapabilities":"Expert in aerospace-grade materials.","supplierRoadmap":{"tasks":[{"task":"Vendor Qualification","start":"2025-01-01","end":"2025-02-15","status":"Complete","category":"Material System Vendor Qual","fundingType":"Division IRAD"},{"task":"Supply Contract Negotiation","start":"2025-03-01","end":"2025-04-30","status":"Planned","category":"Supplier Management"}]},"machines":[1,2]},{"id":"SUP2","name":"Defense Materials Ltd.","materials":["MS2"],"additionalCapabilities":"Specializes in high-temperature alloys.","supplierRoadmap":{"tasks":[{"task":"Initial Evaluation","start":"2025-02-01","end":"2025-03-01","status":"In Progress","category":"Material System Vendor Qual","fundingType":"Sector IRAD"},{"task":"Long-term Partnership Discussion","start":"2025-04-01","end":"2025-05-31","status":"Planned","category":"Supplier Management"}]},"machines":[2,3]},{"id":"SUP3","name":"SpaceTech Supplies","materials":["MS3"],"additionalCapabilities":"Innovative solutions for lightweight materials.","supplierRoadmap":{"tasks":[{"task":"Capability Assessment","start":"2025-01-15","end":"2025-02-28","status":"Complete","category":"Material System Vendor Qual","fundingType":"CRAD"}]},"machines":[1]},{"id":"SUP4","name":"Surface Solutions Inc.","materials":["MS1","MS3"],"additionalCapabilities":"Specializes in surface finishing for aerospace components.","supplierRoadmap":{"tasks":[{"task":"Process Certification","start":"2025-02-01","end":"2025-03-15","status":"Complete","category":"Supplier Management","fundingType":"Division IRAD"}]}},{"id":"SUP5","name":"Anodizing Experts LLC","materials":["MS3"],"additionalCapabilities":"Specialized anodizing for aluminum components.","supplierRoadmap":{"tasks":[{"task":"Quality Audit","start":"2025-03-01","end":"2025-04-15","status":"In Progress","category":"Supplier Management","fundingType":"Sector IRAD"}]}}],"cradOpportunities":[{"id":"OPP1","name":"Advanced SatCom Upgrade","relatedEntity":"P1","details":"Opportunity for enhanced satellite communication systems; potential for increased funding."},{"id":"OPP2","name":"Reusable Rocket Efficiency","relatedEntity":"P4","details":"Focus on improving efficiency of reusable rockets; seeking industry partners."},{"id":"OPP3","name":"Titanium Expansion","relatedEntity":"MS1","details":"Expand usage of Ti-6Al-4V in aerospace applications; high interest in collaboration."},{"id":"OPP4","name":"Inconel Testing Initiative","relatedEntity":"MS2","details":"Pilot project for testing Inconel 718 under extreme conditions; funding secured."}]}
    </script>
  
  


<header>
  <h1>Interactive Roadmap</h1>
</header>

<div class="container">
  <div class="nav-tabs">
    <div class="nav-tab" data-view="programsView">Programs</div>
    <div class="nav-tab" data-view="productsView">Products</div>
    <div class="nav-tab" data-view="amMaterialSystemsView">AM Material Systems</div>
    <div class="nav-tab" data-view="amSuppliersView">AM Suppliers</div>
    <div class="nav-tab" data-view="fundingOpportunitiesView">Funding Opportunities</div>
  </div>
  
  <div id="searchContainer" style="margin: 20px 0;">
    <input type="text" id="searchInput" placeholder="Search..." style="padding: 8px; width: 100%; border: 1px solid #ddd; border-radius: 4px;">
  </div>
  
  <div id="mainView" class="main-content" style="display: block;">
    <h2>Welcome to the Interactive Roadmap</h2>
    <p>Use the navigation tabs above to explore different sections of the roadmap.</p>
  </div>


<div id="programsView" class="detail-view">
  <div class="detail-header">
    <h2>Programs</h2>
    <button class="back-button">Back</button>
  </div>
  <div class="tiles-container">
    
      <div class="tile" data-program-id="PRG1">
        <div class="tile-name">Satellite Systems</div>
        <div class="tile-description">No description available</div>
        <div class="tile-status">
          <strong>Status:</strong> 
          <span class="status-indicator status-planned"></span>
          Planned
        </div>
      </div>
    
      <div class="tile" data-program-id="PRG2">
        <div class="tile-name">Missile Defense</div>
        <div class="tile-description">No description available</div>
        <div class="tile-status">
          <strong>Status:</strong> 
          <span class="status-indicator status-planned"></span>
          Planned
        </div>
      </div>
    
      <div class="tile" data-program-id="PRG3">
        <div class="tile-name">Launch Vehicles</div>
        <div class="tile-description">No description available</div>
        <div class="tile-status">
          <strong>Status:</strong> 
          <span class="status-indicator status-planned"></span>
          Planned
        </div>
      </div>
    
      <div class="tile" data-program-id="PRG4">
        <div class="tile-name">Space Exploration</div>
        <div class="tile-description">No description available</div>
        <div class="tile-status">
          <strong>Status:</strong> 
          <span class="status-indicator status-planned"></span>
          Planned
        </div>
      </div>
    
      <div class="tile" data-program-id="PRG5">
        <div class="tile-name">Communications</div>
        <div class="tile-description">No description available</div>
        <div class="tile-status">
          <strong>Status:</strong> 
          <span class="status-indicator status-planned"></span>
          Planned
        </div>
      </div>
    
  </div>
</div>

<div id="programDetailsView" class="detail-view">
  <div id="programDetailsContent"></div>
</div>


<div id="productsView" class="detail-view">
  <div class="detail-header">
    <h2>Products</h2>
    <button class="back-button">Back</button>
  </div>
  <div class="tiles-container">
    
      <div class="tile" data-product-id="P1">
        <div class="tile-name">SatCom Terminal Housing</div>
        <div class="tile-programs">
          <strong>Programs:</strong> 
          Satellite Systems, Communications
        </div>
      </div>
    
      <div class="tile" data-product-id="P2">
        <div class="tile-name">Weather Satellite Antenna Mount</div>
        <div class="tile-programs">
          <strong>Programs:</strong> 
          Satellite Systems
        </div>
      </div>
    
      <div class="tile" data-product-id="P3">
        <div class="tile-name">Interceptor Missile Nozzle</div>
        <div class="tile-programs">
          <strong>Programs:</strong> 
          Missile Defense
        </div>
      </div>
    
      <div class="tile" data-product-id="P4">
        <div class="tile-name">Reusable Rocket Injector Plate</div>
        <div class="tile-programs">
          <strong>Programs:</strong> 
          Launch Vehicles
        </div>
      </div>
    
      <div class="tile" data-product-id="P5">
        <div class="tile-name">Lunar Rover Wheel Structure</div>
        <div class="tile-programs">
          <strong>Programs:</strong> 
          Space Exploration
        </div>
      </div>
    
  </div>
</div>

<div id="productDetailsView" class="detail-view">
  <div class="detail-header">
    <h2>Product Details</h2>
    <button class="back-button">Back</button>
  </div>
  <div id="productDetails"></div>
  <div id="productPrograms" class="related-items-container"></div>
  <div id="productQuadBox" class="quad-box-wrapper"></div>
</div>


<div id="amMaterialSystemsView" class="detail-view">
  <div class="detail-header">
    <h2>AM Material Systems</h2>
    <button class="back-button">Back</button>
  </div>
  <div class="tiles-container">
    
      <div class="tile" data-material-id="MS1">
        <div class="tile-name">LPBF Ti-6Al-4V</div>
        <div class="tile-qualification">
          <strong>Qualification:</strong> Qualified
        </div>
        <div class="tile-qualification-class">
          <strong>Class:</strong> Class 1
        </div>
      </div>
    
      <div class="tile" data-material-id="MS2">
        <div class="tile-name">LPBF Inconel 718</div>
        <div class="tile-qualification">
          <strong>Qualification:</strong> Pending
        </div>
        <div class="tile-qualification-class">
          <strong>Class:</strong> Class 2
        </div>
      </div>
    
      <div class="tile" data-material-id="MS3">
        <div class="tile-name">LPBF AlSi10Mg</div>
        <div class="tile-qualification">
          <strong>Qualification:</strong> Qualified
        </div>
        <div class="tile-qualification-class">
          <strong>Class:</strong> Class 3
        </div>
      </div>
    
      <div class="tile" data-material-id="MS4">
        <div class="tile-name">EBM Ti-6Al-4V</div>
        <div class="tile-qualification">
          <strong>Qualification:</strong> In Progress
        </div>
        <div class="tile-qualification-class">
          <strong>Class:</strong> Class 4
        </div>
      </div>
    
      <div class="tile" data-material-id="MS5">
        <div class="tile-name">DED 316L Stainless Steel</div>
        <div class="tile-qualification">
          <strong>Qualification:</strong> Qualified
        </div>
        <div class="tile-qualification-class">
          <strong>Class:</strong> Class 5
        </div>
      </div>
    
  </div>
</div>

<div id="materialSystemDetailsView" class="detail-view">
  <div class="detail-header">
    <h2>Material System Details</h2>
    <button class="back-button">Back</button>
  </div>
  <div id="materialSystemDetails"></div>
  <div id="materialSystemSuppliers" class="related-items-container"></div>
</div>


<div id="amSuppliersView" class="detail-view">
  <div class="detail-header">
    <h2>AM Suppliers</h2>
    <button class="back-button">Back</button>
  </div>
  <div class="tiles-container">
    
      <div class="tile" data-supplier-id="SUP1">
        <div class="tile-name">AeroSupplies Inc.</div>
        <div class="tile-materials">
          <strong>Materials:</strong> LPBF Ti-6Al-4V, LPBF AlSi10Mg
        </div>
      </div>
    
      <div class="tile" data-supplier-id="SUP2">
        <div class="tile-name">Defense Materials Ltd.</div>
        <div class="tile-materials">
          <strong>Materials:</strong> LPBF Inconel 718
        </div>
      </div>
    
      <div class="tile" data-supplier-id="SUP3">
        <div class="tile-name">SpaceTech Supplies</div>
        <div class="tile-materials">
          <strong>Materials:</strong> LPBF AlSi10Mg
        </div>
      </div>
    
      <div class="tile" data-supplier-id="SUP4">
        <div class="tile-name">Surface Solutions Inc.</div>
        <div class="tile-materials">
          <strong>Materials:</strong> LPBF Ti-6Al-4V, LPBF AlSi10Mg
        </div>
      </div>
    
      <div class="tile" data-supplier-id="SUP5">
        <div class="tile-name">Anodizing Experts LLC</div>
        <div class="tile-materials">
          <strong>Materials:</strong> LPBF AlSi10Mg
        </div>
      </div>
    
  </div>
</div>

<div id="supplierDetailsView" class="detail-view">
  <div class="detail-header">
    <h2>Supplier Details</h2>
    <button class="back-button">Back</button>
  </div>
  <div id="supplierDetails"></div>
  <div id="supplierMaterials" class="related-items-container"></div>
</div>


<div id="fundingOpportunitiesView" class="detail-view">
  <div class="detail-header">
    <h2>Funding Opportunities</h2>
    <button class="back-button">Back</button>
  </div>
  <div class="tiles-container">
    
      <div class="tile" data-opportunity-id="OPP1">
        <div class="tile-name">Advanced SatCom Upgrade</div>
        <div class="tile-details">Opportunity for enhanced satellite communication systems; potential for increased funding.</div>
        
      </div>
    
      <div class="tile" data-opportunity-id="OPP2">
        <div class="tile-name">Reusable Rocket Efficiency</div>
        <div class="tile-details">Focus on improving efficiency of reusable rockets; seeking industry partners.</div>
        
      </div>
    
      <div class="tile" data-opportunity-id="OPP3">
        <div class="tile-name">Titanium Expansion</div>
        <div class="tile-details">Expand usage of Ti-6Al-4V in aerospace applications; high interest in collaboration.</div>
        
      </div>
    
      <div class="tile" data-opportunity-id="OPP4">
        <div class="tile-name">Inconel Testing Initiative</div>
        <div class="tile-details">Pilot project for testing Inconel 718 under extreme conditions; funding secured.</div>
        
      </div>
    
  </div>
</div>

<div id="fundingOpportunityDetailsView" class="detail-view">
  <div class="detail-header">
    <h2>Funding Opportunity Details</h2>
    <button class="back-button">Back</button>
  </div>
  <div id="fundingOpportunityDetails"></div>
  <div id="relatedEntities" class="related-items-container"></div>
</div>


<div id="taskDetailsView" class="detail-view">
  <div class="detail-header">
    <h2>Task Details</h2>
    <button class="back-button">Back</button>
  </div>
  <div id="taskDetails"></div>
</div>

</div>
  <script>

// Navigation stack to track view history
const navStack = [];

// Debug function to help troubleshoot
function debugElement(selector) {
  const elements = document.querySelectorAll(selector);
  console.log(`Found ${elements.length} elements matching "${selector}"`);
  elements.forEach((el, i) => {
    console.log(`Element ${i}:`, el);
    if (el.id) {
      console.log(`  ID: ${el.id}`);
    }
    if (el.className) {
      console.log(`  Classes: ${el.className}`);
    }
    if (el.getAttribute('data-view')) {
      console.log(`  View: ${el.getAttribute('data-view')}`);
    }
  });
}

// Load the data from the embedded JSON
let roadmapData;
try {
  const dataElement = document.getElementById('roadmap-data');
  if (dataElement) {
    roadmapData = JSON.parse(dataElement.textContent);
    console.log('Roadmap data loaded successfully from embedded JSON');
  } else {
    console.error('Data element not found');
    roadmapData = { programs: [], products: [], materialSystems: [], suppliers: [], cradOpportunities: [] };
  }
  
  // Debug the data structure
  console.log('Programs:', roadmapData.programs ? roadmapData.programs.length : 0);
  console.log('Products:', roadmapData.products ? roadmapData.products.length : 0);
  console.log('Material Systems:', roadmapData.materialSystems ? roadmapData.materialSystems.length : 0);
  console.log('Suppliers:', roadmapData.suppliers ? roadmapData.suppliers.length : 0);
  console.log('Funding Opportunities:', roadmapData.cradOpportunities ? roadmapData.cradOpportunities.length : 0);
  
  // Log the first program if available
  if (roadmapData.programs && roadmapData.programs.length > 0) {
    console.log('First program:', roadmapData.programs[0]);
  }
} catch (error) {
  console.error('Error parsing roadmap data:', error);
  roadmapData = { programs: [], products: [], materialSystems: [], suppliers: [], cradOpportunities: [] };
}

// Initialize the application
document.addEventListener('DOMContentLoaded', function() {
  console.log('DOM fully loaded');
  
  // Debug the navigation tabs
  debugElement('.nav-tab');
  
  // Debug the views
  debugElement('.detail-view');
  debugElement('#mainView');
  
  initializeNavigation();
  attachEventHandlers();
  setupSearch();
  addTooltips();
  
  // Set default view
  const defaultTab = document.querySelector('.nav-tab[data-view="programsView"]');
  if (defaultTab) {
    console.log('Setting default tab:', defaultTab);
    defaultTab.classList.add('active');
    showView('programsView');
  } else {
    console.error('Default tab not found');
  }
});

// Set up navigation and event handlers
function initializeNavigation() {
  console.log('Initializing navigation');
  
  // Set up navigation tabs
  document.querySelectorAll('.nav-tab').forEach(tab => {
    const viewId = tab.getAttribute('data-view');
    console.log('Setting up tab for view:', viewId);
    
    tab.addEventListener('click', function(e) {
      console.log('Tab clicked:', viewId);
      e.preventDefault();
      
      // Update active tab
      document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
      this.classList.add('active');
      
      // Show the selected view
      showView(viewId);
    });
  });
  
  // Add keyboard navigation
  document.addEventListener('keydown', function(e) {
    // ESC key for going back
    if (e.key === 'Escape') {
      goBack();
    }
  });
  
  // Set up back buttons
  document.querySelectorAll('.back-button').forEach(button => {
    button.addEventListener('click', function(e) {
      console.log('Back button clicked');
      e.preventDefault();
      goBack();
    });
  });
}

// Attach event handlers to all interactive elements
function attachEventHandlers() {
  console.log('Attaching event handlers');
  
  // Set up program tile click handlers
  document.querySelectorAll('[data-program-id]').forEach(tile => {
    const programId = tile.getAttribute('data-program-id');
    console.log('Setting up click handler for program:', programId);
    
    tile.addEventListener('click', function() {
      const programId = this.getAttribute('data-program-id');
      console.log('Program tile clicked:', programId);
      
      // Debug the roadmapData object
      console.log('Roadmap data programs:', roadmapData.programs);
      
      const program = roadmapData.programs.find(p => p.id === programId);
      console.log('Found program:', program);
      
      if (program) {
        showProgramDetails(program);
      } else {
        console.error('Program not found:', programId);
        console.error('Available program IDs:', roadmapData.programs.map(p => p.id));
      }
    });
  });
  
  // Set up product tile click handlers
  document.querySelectorAll('[data-product-id]').forEach(tile => {
    const productId = tile.getAttribute('data-product-id');
    console.log('Setting up click handler for product:', productId);
    
    tile.addEventListener('click', function() {
      const productId = this.getAttribute('data-product-id');
      console.log('Product tile clicked:', productId);
      
      // Debug the roadmapData object
      console.log('Roadmap data products:', roadmapData.products);
      
      const product = roadmapData.products.find(p => p.id === productId);
      console.log('Found product:', product);
      
      if (product) {
        showProductDetails(product);
      } else {
        console.error('Product not found:', productId);
        console.error('Available product IDs:', roadmapData.products.map(p => p.id));
      }
    });
  });
  
  // Set up material system tile click handlers
  document.querySelectorAll('[data-material-id]').forEach(tile => {
    const materialId = tile.getAttribute('data-material-id');
    console.log('Setting up click handler for material:', materialId);
    
    tile.addEventListener('click', function() {
      const materialId = this.getAttribute('data-material-id');
      console.log('Material tile clicked:', materialId);
      
      const material = roadmapData.materialSystems.find(m => m.id === materialId);
      if (material) {
        showMaterialDetails(material);
      } else {
        console.error('Material not found:', materialId);
      }
    });
  });
  
  // Set up supplier tile click handlers
  document.querySelectorAll('[data-supplier-id]').forEach(tile => {
    const supplierId = tile.getAttribute('data-supplier-id');
    console.log('Setting up click handler for supplier:', supplierId);
    
    tile.addEventListener('click', function() {
      const supplierId = this.getAttribute('data-supplier-id');
      console.log('Supplier tile clicked:', supplierId);
      
      const supplier = roadmapData.suppliers.find(s => s.id === supplierId);
      if (supplier) {
        showSupplierDetails(supplier);
      } else {
        console.error('Supplier not found:', supplierId);
      }
    });
  });
  
  // Set up funding opportunity tile click handlers
  document.querySelectorAll('[data-opportunity-id]').forEach(tile => {
    const opportunityId = tile.getAttribute('data-opportunity-id');
    console.log('Setting up click handler for opportunity:', opportunityId);
    
    tile.addEventListener('click', function() {
      const opportunityId = this.getAttribute('data-opportunity-id');
      console.log('Opportunity tile clicked:', opportunityId);
      
      const opportunity = roadmapData.cradOpportunities.find(o => o.id === opportunityId);
      if (opportunity) {
        showFundingOpportunityDetails(opportunity);
      } else {
        console.error('Opportunity not found:', opportunityId);
      }
    });
  });
}

// Add tooltips to navigation tabs
function addTooltips() {
  document.querySelectorAll('.nav-tab').forEach(tab => {
    const viewId = tab.getAttribute('data-view');
    let tooltipText = '';
    
    switch (viewId) {
      case 'programsView':
        tooltipText = 'View all programs';
        break;
      case 'productsView':
        tooltipText = 'View all products';
        break;
      case 'amMaterialSystemsView':
        tooltipText = 'View all AM material systems';
        break;
      case 'amSuppliersView':
        tooltipText = 'View all AM suppliers';
        break;
      case 'fundingOpportunitiesView':
        tooltipText = 'View all funding opportunities';
        break;
    }
    
    if (tooltipText) {
      createTooltip(tab, tooltipText);
    }
  });
}

// Helper function for formatting dates
function formatDate(dateStr) {
  if (!dateStr) return 'N/A';
  const date = new Date(dateStr);
  return date.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' });
}

// Navigation functions
function showView(viewId) {
  console.log('Showing view:', viewId);
  
  // Hide all views
  document.querySelectorAll('.detail-view, .main-content').forEach(view => {
    view.style.display = 'none';
  });
  
  // Show the requested view
  const viewElement = document.getElementById(viewId);
  if (viewElement) {
    viewElement.style.display = 'block';
    console.log('View displayed:', viewId);
    
    // Update navigation stack
    navStack.push(viewId);
    console.log('Navigation stack:', navStack);
  } else {
    console.error('View not found:', viewId);
    // List all available views
    console.log('Available views:');
    document.querySelectorAll('.detail-view, .main-content').forEach(view => {
      console.log('- ' + view.id);
    });
  }
}

function goBack() {
  console.log('Going back. Current stack:', navStack);
  
  if (navStack.length > 1) {
    navStack.pop(); // Remove current view
    const previousView = navStack[navStack.length - 1];
    
    // Hide all views
    document.querySelectorAll('.detail-view, .main-content').forEach(view => {
      view.style.display = 'none';
    });
    
    // Show the previous view
    document.getElementById(previousView).style.display = 'block';
    console.log('Returned to view:', previousView);
  } else {
    // If at the root level, show main view
    document.querySelectorAll('.detail-view').forEach(view => {
      view.style.display = 'none';
    });
    document.getElementById('mainView').style.display = 'block';
    navStack.length = 0; // Clear the stack
    console.log('Returned to main view');
  }
}

// Add a helper function to create tooltips
function createTooltip(element, text) {
  element.classList.add('tooltip');
  const tooltipSpan = document.createElement('span');
  tooltipSpan.className = 'tooltip-text';
  tooltipSpan.textContent = text;
  element.appendChild(tooltipSpan);
}

// Add search functionality
function setupSearch() {
  const searchInput = document.getElementById('searchInput');
  if (!searchInput) {
    console.warn('Search input not found');
    return;
  }
  
  console.log('Setting up search functionality');
  searchInput.addEventListener('input', function() {
    const searchTerm = this.value.toLowerCase();
    console.log('Searching for:', searchTerm);
    
    // Search in all tiles
    document.querySelectorAll('.tile').forEach(tile => {
      const tileName = tile.querySelector('.tile-name').textContent.toLowerCase();
      const tileDesc = tile.querySelector('.tile-description')?.textContent.toLowerCase() || '';
      
      if (tileName.includes(searchTerm) || tileDesc.includes(searchTerm)) {
        tile.style.display = 'block';
      } else {
        tile.style.display = 'none';
      }
    });
  });
}

// Add a global error handler to catch any JavaScript errors
window.onerror = function(message, source, lineno, colno, error) {
  console.error('JavaScript error:', message);
  console.error('Source:', source);
  console.error('Line:', lineno, 'Column:', colno);
  console.error('Error object:', error);
  return true;
};


// Create a navigation namespace to avoid conflicts
const Navigation = {
  stack: [],
  
  push: function(view) {
    this.stack.push(view);
    console.log('Navigation stack updated:', this.stack);
  },
  
  goBack: function() {
    if (this.stack.length > 0) {
      const prevView = this.stack.pop();
      console.log('Going back to:', prevView);
      
      // Show the previous view
      if (prevView === 'mainView') {
        this.showView('mainView');
      } else if (prevView === 'programDetailsView') {
        this.showView('programDetailsView');
      } else if (prevView === 'productDetailsView') {
        this.showView('productDetailsView');
      } else if (prevView === 'materialDetailSection') {
        document.querySelectorAll('.detail-view').forEach(view => {
          view.style.display = 'none';
        });
        document.getElementById('materialDetailSection').style.display = 'block';
      } else if (prevView === 'supplierDetailSection') {
        document.querySelectorAll('.detail-view').forEach(view => {
          view.style.display = 'none';
        });
        document.getElementById('supplierDetailSection').style.display = 'block';
      }
    } else {
      // If no previous view, go to main view
      this.showView('programsView'); // Default to programs view
    }
  },
  
  showView: function(viewId) {
    console.log('Showing view:', viewId);
    
    // First, hide all detail views
    document.querySelectorAll('.detail-view').forEach(view => {
      view.style.display = 'none';
    });
    
    // Hide welcome message if it exists
    const welcomeHeadings = document.querySelectorAll('h1, h2, h3');
    welcomeHeadings.forEach(heading => {
      if (heading.textContent.includes('Welcome to the Interactive Roadmap')) {
        // Find a parent container to hide
        let parent = heading;
        // Go up to find a suitable container
        while (parent && !parent.classList.contains('container') && parent.parentElement) {
          parent = parent.parentElement;
        }
        
        // If we found a suitable container that's not the main container, hide it
        if (parent && !parent.classList.contains('container')) {
          parent.style.display = 'none';
        } else if (heading.parentElement) {
          // Otherwise just hide the heading's parent
          heading.parentElement.style.display = 'none';
        }
      }
    });
    
    // Show the requested view
    const targetView = document.getElementById(viewId);
    if (targetView) {
      targetView.style.display = 'block';
    } else {
      console.error('Target view not found:', viewId);
      // Show the programs view as a fallback
      const programsView = document.getElementById('programsView');
      if (programsView) {
        programsView.style.display = 'block';
      }
    }
  }
};

// Define global functions that use our Navigation namespace
function goBack() { Navigation.goBack(); }
function showView(viewId) { Navigation.showView(viewId); }

// Import utility functions first

// Format date helpers
function formatDate(dateString) {
  if (!dateString) return "N/A";
  const date = new Date(dateString);
  return date.toLocaleDateString();
}

function formatDateForInput(date) {
  const d = new Date(date);
  let month = '' + (d.getMonth() + 1);
  let day = '' + d.getDate();
  const year = d.getFullYear();

  if (month.length < 2) month = '0' + month;
  if (day.length < 2) day = '0' + day;

  return [year, month, day].join('-');
}

function getTaskStatusClasses(status, fundingType) {
  const statusLower = (status || "").toLowerCase();
  let classes = "";
  
  if (statusLower === "complete") {
    classes = "complete";
  } else if (statusLower === "in progress") {
    classes = "in-progress";
    
    // Add funding type class if available
    if (fundingType) {
      const fundingTypeLower = fundingType.toLowerCase().replace(/\s+/g, '-');
      classes += ` funding-${fundingTypeLower}`;
    }
  } else {
    classes = "planned";
  }
  
  return classes;
}


// Import visualizations next - before handlers that use them

// Create a roadmap visualization
function createRoadmapVisualization(item, container) {
  console.log('Creating roadmap visualization for:', item.name);
  
  // Check if the container exists
  if (!container) {
    console.error('Roadmap container not found');
    return;
  }
  
  // Clear the container
  container.innerHTML = '';
  
  // Get timeline data - could be from a program or product
  const timeline = item.timeline || [];
  
  // Create the roadmap visualization
  if (timeline && timeline.length > 0) {
    // Sort timeline items by date
    const sortedTimeline = [...timeline].sort((a, b) => {
      return new Date(a.date) - new Date(b.date);
    });
    
    // Find min and max dates for scaling
    const minDate = new Date(sortedTimeline[0].date);
    const maxDate = new Date(sortedTimeline[sortedTimeline.length - 1].date);
    
    // Add some padding to the date range (3 months)
    minDate.setMonth(minDate.getMonth() - 3);
    maxDate.setMonth(maxDate.getMonth() + 3);
    
    // Calculate the total time span in milliseconds
    const timeSpan = maxDate - minDate;
    
    // Create the roadmap HTML
    let roadmapHtml = `
      <div class="roadmap-timeline">
        <div class="timeline-header">
          <div class="timeline-start-date">${formatDate(minDate)}</div>
          <div class="timeline-end-date">${formatDate(maxDate)}</div>
        </div>
        <div class="timeline-track">
    `;
    
    // Add timeline items
    sortedTimeline.forEach(item => {
      const itemDate = new Date(item.date);
      // Calculate position as percentage of total time span
      const position = ((itemDate - minDate) / timeSpan) * 100;
      
      roadmapHtml += `
        <div class="timeline-item ${item.type ? item.type.toLowerCase() : 'milestone'}" 
             style="left: ${position}%">
          <div class="timeline-item-marker"></div>
          <div class="timeline-item-label">${item.name}</div>
          <div class="timeline-item-date">${formatDate(itemDate)}</div>
          ${item.description ? `<div class="timeline-item-description">${item.description}</div>` : ''}
        </div>
      `;
    });
    
    roadmapHtml += `
        </div>
      </div>
    `;
    
    container.innerHTML = roadmapHtml;
  } else {
    container.innerHTML = '<p>No timeline data available.</p>';
  }
}


// Create a quad box visualization for a product
function createQuadBox(product, container) {
  console.log('Creating quad box for product:', product.name);
  
  // Get all material systems for this product
  const materialSystems = product.materialSystems && product.materialSystems.length > 0 
    ? product.materialSystems.map(id => roadmapData.materialSystems.find(m => m.id === id)).filter(Boolean)
    : [];
  
  // Default to first material system if available
  const defaultMaterial = materialSystems.length > 0 ? materialSystems[0] : null;
  
  // Create a specialized quad box layout for product details
  container.innerHTML = `
    <h3>Product Development Status</h3>
    
    <!-- Material System Filter Buttons -->
    <div class="material-system-filters">
      ${materialSystems.length > 0 ? `
        <div class="filter-label">Select Material System:</div>
        <div class="filter-buttons">
          ${materialSystems.map((material, index) => `
            <button class="material-filter-btn ${index === 0 ? 'active' : ''}" 
                    data-material-id="${material.id}">
              ${material.name}
            </button>
          `).join('')}
        </div>
      ` : '<p>No material systems available</p>'}
    </div>
    
    <!-- Product Development Progress Module -->
    <div class="product-development-progress">
      <div class="progress-section">
        <h4>TRL</h4>
        <div class="progress-container">
          <div class="progress-bar-wrapper">
            <div class="progress-bar trl-progress" style="width: ${(product.trl || 1) * 11.1}%">
              <span class="progress-current">${product.trl || 'N/A'}</span>
            </div>
          </div>
          <div class="progress-labels">
            <span class="progress-min">1</span>
            <span class="progress-max">9</span>
          </div>
        </div>
      </div>
      
      <div class="progress-section">
        <h4>MRL</h4>
        <div class="progress-container">
          <div class="progress-bar-wrapper">
            <div class="progress-bar mrl-progress" style="width: ${(defaultMaterial && defaultMaterial.mrl ? defaultMaterial.mrl : 1) * 10}%">
              <span class="progress-current">${defaultMaterial && defaultMaterial.mrl ? defaultMaterial.mrl : 'N/A'}</span>
            </div>
          </div>
          <div class="progress-labels">
            <span class="progress-min">1</span>
            <span class="progress-max">10</span>
          </div>
        </div>
      </div>
    </div>
    
    <div class="specialized-quad-box">
      <!-- Material Systems Quadrant -->
      <div class="quad-section material-section">
        <h4>Material Systems</h4>
        <div class="quad-content material-content">
          ${materialSystems.length > 0 ? materialSystems.map((material, index) => `
            <div class="material-system-details" id="material-${material.id}" 
                 style="display: ${index === 0 ? 'block' : 'none'}">
              <h5>${material.name}</h5>
              <div class="material-details">
                <p><strong>Process:</strong> ${material.process || 'N/A'}</p>
                <p><strong>Qualification:</strong> ${material.qualification || 'N/A'}</p>
                <p><strong>Qualification Class:</strong> ${material.qualificationClass || 'N/A'}</p>
                <p><strong>Statistical Basis:</strong> ${material.statisticalBasis || 'None'}</p>
                
                ${material.postProcessing && material.postProcessing.length > 0 ? `
                  <div class="material-post-processing">
                    <p><strong>Post Processing:</strong></p>
                    <ul class="post-processing-list" style="list-style-type: disc;">
                      ${material.postProcessing.map(process => `<li>${process}</li>`).join('')}
                    </ul>
                  </div>
                ` : ''}
                
                <div class="view-details-button-container">
                  <button class="view-details-button material-details-btn" 
                          data-material-id="${material.id}">
                    View Full Details
                  </button>
                </div>
              </div>
            </div>
          `).join('') : '<p>No material systems specified</p>'}
        </div>
      </div>
      
      <!-- Design Quadrant -->
      <div class="quad-section design-section">
        <h4>Design</h4>
        <div class="quad-content design-content">
          ${product.designTools && product.designTools.length > 0 ? `
            <h5>Design Tools</h5>
            <ul class="design-list">
              ${product.designTools.map(tool => `<li>${tool}</li>`).join('')}
            </ul>` : 
            ''
          }
          
          ${product.documentation && product.documentation.length > 0 ? `
            <h5>Documentation</h5>
            <ul class="design-list">
              ${product.documentation.map(doc => `<li>${doc}</li>`).join('')}
            </ul>` : 
            ''
          }
        </div>
      </div>
      
      <!-- Manufacturing Quadrant -->
      <div class="quad-section manufacturing-section">
        <h4>Manufacturing</h4>
        <div class="quad-content manufacturing-content">
          ${materialSystems.length > 0 ? materialSystems.map((material, index) => `
            <div class="manufacturing-for-material" id="manufacturing-${material.id}" 
                 style="display: ${index === 0 ? 'block' : 'none'}">
              
              <!-- Qualified Machines -->
              ${material.qualifiedMachines && material.qualifiedMachines.length > 0 ? `
                <div class="qualified-machines">
                  <h5>Qualified Machines</h5>
                  <ul class="machines-list">
                    ${material.qualifiedMachines.map(machine => `<li>${machine}</li>`).join('')}
                  </ul>
                </div>
              ` : ''}
              
              <!-- Relevant Suppliers as Tiles -->
              ${(() => {
                // Find suppliers that support this material
                const relevantSuppliers = roadmapData.suppliers.filter(
                  s => s.materials && s.materials.includes(material.id)
                );
                
                return relevantSuppliers.length > 0 ? `
                  <div class="relevant-suppliers">
                    <h5>Printing Suppliers</h5>
                    <div class="supplier-tiles">
                      ${relevantSuppliers.map(supplier => `
                        <div class="supplier-tile">
                          <a href="#" class="supplier-link" data-supplier-id="${supplier.id}">
                            ${supplier.name}
                          </a>
                        </div>
                      `).join('')}
                    </div>
                  </div>
                ` : '';
              })()}
              
              <!-- Post Processing Suppliers -->
              ${(() => {
                // Find post processing suppliers for this material
                const postProcessingSuppliers = product.postProcessingSuppliers ? 
                  product.postProcessingSuppliers.filter(pps => {
                    const supplier = roadmapData.suppliers.find(s => s.id === pps.supplier);
                    return supplier;
                  }) : [];
                
                return postProcessingSuppliers.length > 0 ? `
                  <div class="post-processing-suppliers">
                    <h5>Post Processing Suppliers</h5>
                    <div class="supplier-tiles">
                      ${postProcessingSuppliers.map(ppSupplier => {
                        const supplier = roadmapData.suppliers.find(s => s.id === ppSupplier.supplier);
                        return supplier ? `
                          <div class="supplier-tile">
                            <a href="#" class="supplier-link" data-supplier-id="${supplier.id}">
                              <span class="supplier-name">${supplier.name}</span>
                              <span class="process-name">${ppSupplier.process}</span>
                            </a>
                          </div>
                        ` : '';
                      }).join('')}
                    </div>
                  </div>
                ` : '';
              })()}
            </div>
          `).join('') : ''}
          
          <!-- Product-specific manufacturing info (always shown) -->
          ${product.relevantMachines && product.relevantMachines.length > 0 ? `
            <div class="product-machines">
              <h5>Product-Specific Machines</h5>
              <ul class="machines-list">
                ${product.relevantMachines.map(machine => `<li>${machine}</li>`).join('')}
              </ul>
            </div>` : 
            ''
          }
        </div>
      </div>
      
      <!-- Quality Quadrant -->
      <div class="quad-section quality-section">
        <h4>Quality</h4>
        <div class="quad-content quality-content">
          ${materialSystems.length > 0 ? materialSystems.map((material, index) => `
            <div class="quality-for-material" id="quality-${material.id}" 
                 style="display: ${index === 0 ? 'block' : 'none'}">
              
              <!-- Standard NDT -->
              ${material.standardNDT && material.standardNDT.length > 0 ? `
                <div class="standard-ndt">
                  <h5>Standard NDT</h5>
                  <ul class="ndt-list">
                    ${material.standardNDT.map(ndt => `<li>${ndt}</li>`).join('')}
                  </ul>
                </div>
              ` : ''}
            </div>
          `).join('') : ''}
          
          <!-- Product-specific quality info (always shown) -->
          ${product.specialNDT && product.specialNDT.length > 0 ? `
            <div class="special-ndt">
              <h5>Product Specific NDT</h5>
              <ul class="ndt-list">
                ${product.specialNDT.map(ndt => `<li>${ndt}</li>`).join('')}
              </ul>
            </div>` : 
            ''
          }
          
          ${product.partAcceptance && product.partAcceptance.length > 0 ? `
            <div class="part-acceptance">
              <h5>Part Acceptance</h5>
              <ul class="ndt-list">
                ${product.partAcceptance.map(acceptance => `<li>${acceptance}</li>`).join('')}
              </ul>
            </div>` : 
            ''
          }
        </div>
      </div>
    </div>
    
    <style>
      /* Consistent styling for the quad box */
      .specialized-quad-box {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        grid-template-rows: repeat(2, minmax(250px, auto));
        gap: 15px;
        margin-top: 20px;
      }
      
      .quad-section {
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 15px;
        background-color: #f9f9f9;
        overflow: auto;
        max-height: 350px;
      }
      
      /* Material Systems - Blue */
      .material-section h4 {
        margin-top: 0;
        padding-bottom: 8px;
        border-bottom: 2px solid #0056b3;
        color: #0056b3;
        font-size: 16px;
      }
      
      /* Design - Dark Green */
      .design-section h4 {
        margin-top: 0;
        padding-bottom: 8px;
        border-bottom: 2px solid #2e7d32;
        color: #2e7d32;
        font-size: 16px;
      }
      
      /* Manufacturing - Deep Pink */
      .manufacturing-section h4 {
        margin-top: 0;
        padding-bottom: 8px;
        border-bottom: 2px solid #c2185b;
        color: #c2185b;
        font-size: 16px;
      }
      
      /* Quality - Orange */
      .quality-section h4 {
        margin-top: 0;
        padding-bottom: 8px;
        border-bottom: 2px solid #e65100;
        color: #e65100;
        font-size: 16px;
      }
      
      .quad-section h5 {
        color: #333;
        margin: 12px 0 8px 0;
        font-size: 14px;
        font-weight: bold;
      }
      
      .quad-content {
        font-size: 14px;
      }
      
      .quad-content ul {
        margin: 5px 0;
        padding-left: 20px;
      }
      
      .quad-content li {
        margin-bottom: 5px;
      }
      
      /* Supplier tiles styling */
      .supplier-tiles {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: 10px;
      }
      
      .supplier-tile {
        background-color: #e6f2ff;
        border-radius: 6px;
        padding: 8px 12px;
        border: 1px solid #c2185b;
        background-color: #fce4ec;
      }
      
      .supplier-tile a {
        text-decoration: none;
        color: #c2185b;
        display: flex;
        flex-direction: column;
      }
      
      .supplier-tile .process-name {
        font-size: 12px;
        color: #666;
        margin-top: 3px;
      }
      
      /* Consistent list styling */
      .machines-list, .ndt-list, .post-processing-list, .design-list {
        list-style-type: disc;
      }
      
      /* Material filter buttons */
      .material-system-filters {
        margin-bottom: 15px;
      }
      
      .filter-buttons {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-top: 8px;
      }
      
      .material-filter-btn {
        padding: 6px 12px;
        background-color: #f0f0f0;
        border: 1px solid #ddd;
        border-radius: 4px;
        cursor: pointer;
      }
      
      .material-filter-btn.active {
        background-color: #0056b3;
        color: white;
        border-color: #0056b3;
      }
      
      /* Progress bars */
      .progress-section {
        margin-bottom: 15px;
      }
      
      .progress-bar-wrapper {
        height: 20px;
        background-color: #e9ecef;
        border-radius: 4px;
        margin: 8px 0;
      }
      
      .progress-bar {
        height: 100%;
        border-radius: 4px;
        background-color: #0056b3;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      
      .progress-bar .progress-current {
        color: white;
        font-weight: bold;
        text-shadow: 1px 1px 1px rgba(0,0,0,0.5);
      }
      
      .progress-labels {
        display: flex;
        justify-content: space-between;
        font-size: 14px;
      }
    </style>
    
    <h3>Technical Roadmap</h3>
    <div id="productRoadmapContainer" class="roadmap-container"></div>
  `;
  
  // Add event listeners to material filter buttons
  container.querySelectorAll('.material-filter-btn').forEach(button => {
    button.addEventListener('click', function() {
      const materialId = this.getAttribute('data-material-id');
      const selectedMaterial = roadmapData.materialSystems.find(m => m.id === materialId);
      
      // Update MRL progress bar based on selected material
      if (selectedMaterial && selectedMaterial.mrl) {
        const mrlProgressBar = container.querySelector('.mrl-progress');
        const mrlCurrentLabel = container.querySelector('.mrl-progress .progress-current');
        
        if (mrlProgressBar) {
          mrlProgressBar.style.width = `${selectedMaterial.mrl * 10}%`;
        }
        
        if (mrlCurrentLabel) {
          mrlCurrentLabel.textContent = `${selectedMaterial.mrl}`;
        }
      }
      
      // Update active button
      container.querySelectorAll('.material-filter-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      this.classList.add('active');
      
      // Hide all material details and show the selected one
      container.querySelectorAll('.material-system-details').forEach(div => {
        div.style.display = 'none';
      });
      container.querySelector(`#material-${materialId}`).style.display = 'block';
      
      // Hide all manufacturing details and show the selected one
      container.querySelectorAll('.manufacturing-for-material').forEach(div => {
        div.style.display = 'none';
      });
      const manufacturingDiv = container.querySelector(`#manufacturing-${materialId}`);
      if (manufacturingDiv) {
        manufacturingDiv.style.display = 'block';
      }
      
      // Hide all quality details and show the selected one
      container.querySelectorAll('.quality-for-material').forEach(div => {
        div.style.display = 'none';
      });
      const qualityDiv = container.querySelector(`#quality-${materialId}`);
      if (qualityDiv) {
        qualityDiv.style.display = 'block';
      }
    });
  });
  
  // Add event listeners to material details buttons
  container.querySelectorAll('.material-details-btn').forEach(button => {
    button.addEventListener('click', function() {
      const materialId = this.getAttribute('data-material-id');
      const material = roadmapData.materialSystems.find(m => m.id === materialId);
      if (material) {
        showMaterialDetails(material);
      }
    });
  });
  
  // Add event listeners to supplier links
  container.querySelectorAll('.supplier-link').forEach(link => {
    link.addEventListener('click', function(e) {
      e.preventDefault();
      const supplierId = this.getAttribute('data-supplier-id');
      const supplier = roadmapData.suppliers.find(s => s.id === supplierId);
      if (supplier) {
        showSupplierDetails(supplier);
      }
    });
  });
}


// Import handlers last - after the visualizations they depend on

// Program details handler
function showProgramDetails(program) {
  console.log('Showing program details for:', program.id);
  
  // Find products related to this program
  const relatedProducts = roadmapData.products.filter(product => 
    product.programs && product.programs.includes(program.id)
  );
  
  console.log('Related products:', relatedProducts.map(p => p.name));
  
  // Create the program details HTML
  const detailsContent = document.getElementById('programDetailsContent');
  if (!detailsContent) {
    console.error('Program details content element not found');
    return;
  }
  
  // Clear previous content
  detailsContent.innerHTML = '';
  
  // Create the main program information section
  const programInfo = document.createElement('div');
  programInfo.className = 'program-details';
  
  programInfo.innerHTML = `
    <h1>${program.name}</h1>
    
    <div class="program-details-info">
      <p><strong>Customer Name:</strong> ${program.customerName || 'N/A'}</p>
      <p><strong>Division:</strong> ${program.division || 'N/A'}</p>
      <p><strong>Mission Class:</strong> ${program.missionClass || 'N/A'}</p>
      <p><strong>Need Date:</strong> ${program.needDate ? formatDate(program.needDate) : 'N/A'}</p>
    </div>
    
    <h2>Products of Interest</h2>
    <div class="products-grid">
      ${relatedProducts.map(product => `
        <div class="product-card" data-product-id="${product.id}">
          <h3 class="product-name">${product.name}</h3>
          <div class="product-status">
            <p><strong>Qual Status:</strong> N/A</p>
            <p><strong>Completion Date:</strong> ${product.completionDate || 'N/A'}</p>
            <p><strong>Implementation Status:</strong> ${product.implementationStatus || 'N/A'}</p>
          </div>
        </div>
      `).join('')}
    </div>
    
    <button class="back-button">Back</button>
  `;
  
  // Add the program info to the details content
  detailsContent.appendChild(programInfo);
  
  // Add click handlers to the product cards
  programInfo.querySelectorAll('.product-card').forEach(card => {
    card.addEventListener('click', function() {
      const productId = this.getAttribute('data-product-id');
      const product = roadmapData.products.find(p => p.id === productId);
      if (product) {
        showProductDetails(product);
      }
    });
  });
  
  // Add click handler to the back button
  programInfo.querySelector('.back-button').addEventListener('click', function() {
    goBack();
  });
  
  // Show the program details view
  showView('programDetailsView');
}


// Product details handler
function showProductDetails(product) {
  console.log('Showing product details for:', product.name);
  const mainContent = document.getElementById('mainContent');
  
  // Clear previous content
  mainContent.innerHTML = '';
  
  // Create product details container
  const productDetailsContainer = document.createElement('div');
  productDetailsContainer.className = 'product-details-container';
  
  // Create header with back button at top right
  productDetailsContainer.innerHTML = `
    <div class="product-header">
      <h2>Product Details</h2>
      <button class="back-button" onclick="showProductsView()">Back</button>
    </div>
    
    <div class="product-title-section">
      <h3>${product.name}</h3>
      
      <div class="product-basic-info">
        ${product.requirements ? `
          <div class="requirements-section">
            <h4>Requirements</h4>
            ${product.requirements.mechanical ? `<p><strong>Mechanical:</strong> ${product.requirements.mechanical}</p>` : ''}
            ${product.requirements.electrical ? `<p><strong>Electrical:</strong> ${product.requirements.electrical}</p>` : ''}
            ${product.requirements.environmental ? `<p><strong>Environmental:</strong> ${product.requirements.environmental}</p>` : ''}
            ${product.requirements.thermal ? `<p><strong>Thermal:</strong> ${product.requirements.thermal}</p>` : ''}
            ${product.requirements.performance ? `<p><strong>Performance:</strong> ${product.requirements.performance}</p>` : ''}
          </div>
        ` : ''}
        
        ${product.businessCase ? `
          <div class="business-case-section">
            <h4>Business Case</h4>
            ${product.businessCase.costSavings ? `<p><strong>Cost Savings:</strong> ${product.businessCase.costSavings}</p>` : ''}
            ${product.businessCase.scheduleSavings ? `<p><strong>Schedule Savings:</strong> ${product.businessCase.scheduleSavings}</p>` : ''}
            ${product.businessCase.performanceGains ? `<p><strong>Performance Gains:</strong> ${product.businessCase.performanceGains}</p>` : ''}
          </div>
        ` : ''}
        
        ${product.productSupplyChain ? `<p><strong>Make/Buy:</strong> ${product.productSupplyChain}</p>` : ''}
      </div>
    </div>
  `;
  
  // Append product details container to main content
  mainContent.appendChild(productDetailsContainer);
  
  // Create quad box container
  const quadBoxContainer = document.createElement('div');
  quadBoxContainer.className = 'quad-box-container';
  mainContent.appendChild(quadBoxContainer);
  
  // Create quad box visualization - ensure the container is in the DOM first
  setTimeout(() => {
    console.log('Creating quad box for:', product.name);
    if (typeof createQuadBox === 'function') {
      createQuadBox(product, quadBoxContainer);
    } else {
      console.error('createQuadBox function not found');
      quadBoxContainer.innerHTML = '<p>Error: Unable to load visualization</p>';
    }
  }, 0);
  
  // Create related programs section
  if (product.programs && product.programs.length > 0) {
    const relatedProgramsContainer = document.createElement('div');
    relatedProgramsContainer.className = 'related-programs-container';
    
    // Get program details
    const relatedPrograms = product.programs.map(programId => 
      roadmapData.programs.find(p => p.id === programId)
    ).filter(Boolean);
    
    if (relatedPrograms.length > 0) {
      relatedProgramsContainer.innerHTML = `
        <h3>Related Programs</h3>
        <div class="program-cards">
          ${relatedPrograms.map(program => `
            <div class="program-card">
              <h4>${program.name}</h4>
              <p><span class="status-indicator ${getStatusClass(program)}"></span> ${getStatusText(program)}</p>
            </div>
          `).join('')}
        </div>
      `;
      
      mainContent.appendChild(relatedProgramsContainer);
    }
  }
  
  // Add CSS for the product details page
  const style = document.createElement('style');
  style.textContent = `
    .product-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    
    .back-button {
      background-color: #0056b3;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
    }
    
    .product-title-section {
      background-color: #f8f9fa;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 30px;
      border-left: 5px solid #6a1b9a;
    }
    
    .product-title-section h3 {
      color: #6a1b9a;
      margin-top: 0;
      margin-bottom: 15px;
      font-size: 24px;
    }
    
    .product-basic-info {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }
    
    .requirements-section, .business-case-section {
      background-color: white;
      border-radius: 6px;
      padding: 15px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    
    .requirements-section h4, .business-case-section h4 {
      margin-top: 0;
      color: #333;
      border-bottom: 1px solid #ddd;
      padding-bottom: 8px;
      margin-bottom: 12px;
    }
    
    .related-programs-container {
      margin-top: 30px;
    }
    
    .program-cards {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
    }
    
    .program-card {
      background-color: #f8f9fa;
      border-radius: 6px;
      padding: 15px;
      min-width: 200px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    
    .program-card h4 {
      margin-top: 0;
      margin-bottom: 10px;
    }
    
    .status-indicator {
      display: inline-block;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      margin-right: 8px;
    }
    
    .status-planned {
      background-color: #2196F3;
    }
    
    .status-in-progress {
      background-color: #FF9800;
    }
    
    .status-complete {
      background-color: #4CAF50;
    }
    
    .quad-box-container {
      margin-bottom: 30px;
    }
  `;
  
  document.head.appendChild(style);
}

function getStatusClass(program) {
  // Determine status based on dates or explicit status field
  if (program.status) {
    return `status-${program.status.toLowerCase().replace(' ', '-')}`;
  }
  
  const now = new Date();
  const needDate = program.needDate ? new Date(program.needDate) : null;
  const closeDate = program.closeDate ? new Date(program.closeDate) : null;
  
  if (closeDate && now > closeDate) {
    return 'status-complete';
  } else if (needDate && now > needDate) {
    return 'status-in-progress';
  } else {
    return 'status-planned';
  }
}

function getStatusText(program) {
  if (program.status) {
    return program.status;
  }
  
  const now = new Date();
  const needDate = program.needDate ? new Date(program.needDate) : null;
  const closeDate = program.closeDate ? new Date(program.closeDate) : null;
  
  if (closeDate && now > closeDate) {
    return 'Complete';
  } else if (needDate && now > needDate) {
    return 'In Progress';
  } else {
    return 'Planned';
  }
}


// Material system details handler
function showMaterialDetails(material) {
  console.log('Showing material system details for:', material.name);
  
  // Get related products that use this material
  const relatedProducts = roadmapData.products.filter(p => 
    p.materialSystems && p.materialSystems.includes(material.id)
  );
  
  // Create the detail view HTML
  let html = `
    <div class="material-detail-content">
      <h2>${material.name}</h2>
      
      <div class="material-info">
        <p><strong>Material Type:</strong> ${material.type || 'N/A'}</p>
        <p><strong>Qualification Status:</strong> ${material.qualification || 'N/A'}</p>
        <p><strong>Qualification Class:</strong> ${material.qualificationClass || 'N/A'}</p>
        <p><strong>Supplier:</strong> ${material.supplier || 'N/A'}</p>
      </div>
      
      <h3>Properties</h3>
      <div class="material-properties">`;
  
  // Add material properties if they exist
  if (material.properties) {
    html += `<table class="properties-table">
      <thead>
        <tr>
          <th>Property</th>
          <th>Value</th>
          <th>Unit</th>
        </tr>
      </thead>
      <tbody>`;
    
    for (const [key, value] of Object.entries(material.properties)) {
      html += `
        <tr>
          <td>${key.charAt(0).toUpperCase() + key.slice(1)}</td>
          <td>${value.value || 'N/A'}</td>
          <td>${value.unit || ''}</td>
        </tr>`;
    }
    
    html += `</tbody>
    </table>`;
  } else {
    html += `<p>No specific properties defined.</p>`;
  }
  
  html += `</div>
    
    <h3>Related Products</h3>
    <div class="related-products">`;
  
  // Add related products
  if (relatedProducts.length > 0) {
    html += `<ul class="product-list">`;
    relatedProducts.forEach(product => {
      html += `<li><a href="#" class="product-link" data-product-id="${product.id}">${product.name}</a></li>`;
    });
    html += `</ul>`;
  } else {
    html += `<p>No products are using this material system.</p>`;
  }
  
  html += `</div>
    
    <h3>Material Roadmap</h3>`;
  
  // Add material roadmap if it exists
  if (material.roadmap && material.roadmap.length > 0) {
    html += `
      <div class="material-roadmap">
        <table class="roadmap-table">
          <thead>
            <tr>
              <th>Task</th>
              <th>Start Date</th>
              <th>End Date</th>
              <th>Status</th>
              <th>Funding Type</th>
            </tr>
          </thead>
          <tbody>`;
    
    material.roadmap.forEach(task => {
      html += `
        <tr class="${task.status ? task.status.toLowerCase().replace(/\s+/g, '-') : ''}">
          <td>${task.task}</td>
          <td>${task.start ? new Date(task.start).toLocaleDateString() : 'N/A'}</td>
          <td>${task.end ? new Date(task.end).toLocaleDateString() : 'N/A'}</td>
          <td>${task.status || 'N/A'}</td>
          <td>${task.fundingType || 'N/A'}</td>
        </tr>`;
    });
    
    html += `</tbody>
        </table>
      </div>`;
  } else {
    html += `<p>No roadmap defined for this material system.</p>`;
  }
  
  html += `
    <button class="back-button">Back</button>
    </div>`;
  
  // Get or create the material detail section
  let detailSection = document.getElementById('materialDetailSection');
  
  // If the section doesn't exist, create it
  if (!detailSection) {
    console.log('Material detail section not found, creating it');
    detailSection = document.createElement('div');
    detailSection.id = 'materialDetailSection';
    detailSection.className = 'detail-view';
    document.querySelector('.container').appendChild(detailSection);
  }
  
  // Set the content
  detailSection.innerHTML = html;
  
  // Add styles for the material detail content
  const styleElement = document.createElement('style');
  styleElement.textContent = `
    .material-detail-content {
      padding: 20px;
    }
    .material-info {
      background-color: #f5f5f5;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 20px;
    }
    .properties-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }
    .properties-table th, .properties-table td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }
    .properties-table th {
      background-color: #f2f2f2;
    }
    .roadmap-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }
    .roadmap-table th, .roadmap-table td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }
    .roadmap-table th {
      background-color: #f2f2f2;
    }
    .roadmap-table tr.complete {
      background-color: #e8f5e9;
    }
    .roadmap-table tr.in-progress {
      background-color: #e3f2fd;
    }
    .roadmap-table tr.planned {
      background-color: #f5f5f5;
    }
    .product-list {
      list-style-type: none;
      padding: 0;
    }
    .product-list li {
      margin-bottom: 8px;
    }
    .product-link {
      color: #00269A;
      text-decoration: none;
    }
    .product-link:hover {
      text-decoration: underline;
    }
  `;
  document.head.appendChild(styleElement);
  
  // Add event listener to the back button
  detailSection.querySelector('.back-button').addEventListener('click', function(e) {
    e.preventDefault();
    goBack();
  });
  
  // Add event listeners to product links
  detailSection.querySelectorAll('.product-link').forEach(link => {
    link.addEventListener('click', function(e) {
      e.preventDefault();
      const productId = this.getAttribute('data-product-id');
      const product = roadmapData.products.find(p => p.id === productId);
      if (product) {
        Navigation.stack.push('materialDetailSection');
        showProductDetails(product);
      }
    });
  });
  
  // Show the material detail section and hide other views
  // First, hide all main views
  document.querySelectorAll('.main-view').forEach(view => {
    view.style.display = 'none';
  });
  
  // Then hide all detail views
  document.querySelectorAll('.detail-view').forEach(view => {
    view.style.display = 'none';
  });
  
  // Finally, show our material detail section
  detailSection.style.display = 'block';
  
  // Also update the navigation stack
  Navigation.stack.push('materialDetailSection');
  console.log('Navigation stack updated:', navStack);
}


// Supplier details handler
function showSupplierDetails(supplier) {
  console.log('Showing supplier details for:', supplier.name);
  
  // Get materials provided by this supplier
  const relatedMaterials = roadmapData.materialSystems.filter(m => 
    supplier.materials && supplier.materials.includes(m.id)
  );
  
  // Create the detail view HTML
  let html = `
    <div class="supplier-detail-content">
      <h2>${supplier.name}</h2>
      
      <div class="supplier-info">
        <p><strong>Location:</strong> ${supplier.location || 'N/A'}</p>
        <p><strong>Contact:</strong> ${supplier.contact || 'N/A'}</p>
        <p><strong>Website:</strong> ${supplier.website ? 
          `<a href="${supplier.website}" target="_blank">${supplier.website}</a>` : 'N/A'}</p>
        <p><strong>Capabilities:</strong> ${supplier.capabilities || 'N/A'}</p>
      </div>
      
      <h3>Provided Materials</h3>
      <div class="supplier-materials">`;
  
  // Add related materials
  if (relatedMaterials.length > 0) {
    html += `<ul class="material-list">`;
    relatedMaterials.forEach(material => {
      html += `<li><a href="#" class="material-link" data-material-id="${material.id}">${material.name}</a></li>`;
    });
    html += `</ul>`;
  } else {
    html += `<p>No specific materials listed for this supplier.</p>`;
  }
  
  html += `</div>
    
    <h3>Certifications</h3>
    <div class="supplier-certifications">`;
  
  // Add certifications if they exist
  if (supplier.certifications && supplier.certifications.length > 0) {
    html += `<ul class="certification-list">`;
    supplier.certifications.forEach(cert => {
      html += `<li>${cert}</li>`;
    });
    html += `</ul>`;
  } else {
    html += `<p>No certifications listed.</p>`;
  }
  
  html += `</div>
    
    <h3>Notes</h3>
    <div class="supplier-notes">
      <p>${supplier.notes || 'No additional notes available.'}</p>
    </div>
    
    <button class="back-button">Back</button>
    </div>`;
  
  // Get or create the supplier detail section
  let detailSection = document.getElementById('supplierDetailSection');
  
  // If the section doesn't exist, create it
  if (!detailSection) {
    console.log('Supplier detail section not found, creating it');
    detailSection = document.createElement('div');
    detailSection.id = 'supplierDetailSection';
    detailSection.className = 'detail-view';
    document.querySelector('.container').appendChild(detailSection);
  }
  
  // Set the content
  detailSection.innerHTML = html;
  
  // Add styles for the supplier detail content
  const styleElement = document.createElement('style');
  styleElement.textContent = `
    .supplier-detail-content {
      padding: 20px;
    }
    .supplier-info {
      background-color: #f5f5f5;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 20px;
    }
    .material-list, .certification-list {
      list-style-type: none;
      padding: 0;
    }
    .material-list li, .certification-list li {
      margin-bottom: 8px;
    }
    .material-link {
      color: #00269A;
      text-decoration: none;
    }
    .material-link:hover {
      text-decoration: underline;
    }
    .supplier-notes {
      background-color: #fffde7;
      border-left: 4px solid #ffd600;
      padding: 10px 15px;
      margin-bottom: 20px;
    }
  `;
  document.head.appendChild(styleElement);
  
  // Add event listener to the back button
  detailSection.querySelector('.back-button').addEventListener('click', function(e) {
    e.preventDefault();
    goBack();
  });
  
  // Add event listeners to material links
  detailSection.querySelectorAll('.material-link').forEach(link => {
    link.addEventListener('click', function(e) {
      e.preventDefault();
      const materialId = this.getAttribute('data-material-id');
      const material = roadmapData.materialSystems.find(m => m.id === materialId);
      if (material) {
        Navigation.stack.push('supplierDetailSection');
        showMaterialDetails(material);
      }
    });
  });
  
  // Show the supplier detail section and hide other views
  // First, hide all main views
  document.querySelectorAll('.main-view').forEach(view => {
    view.style.display = 'none';
  });
  
  // Then hide all detail views
  document.querySelectorAll('.detail-view').forEach(view => {
    view.style.display = 'none';
  });
  
  // Finally, show our supplier detail section
  detailSection.style.display = 'block';
  
  // Also update the navigation stack
  Navigation.stack.push('supplierDetailSection');
  console.log('Navigation stack updated:', navStack);
}


// Initialize by hiding welcome section when any tab is clicked
document.addEventListener('DOMContentLoaded', function() {
  // Add click handlers to the navigation tabs
  const tabs = document.querySelectorAll('.nav-tab');
  tabs.forEach(tab => {
    tab.addEventListener('click', function() {
      const viewId = this.getAttribute('data-view');
      if (viewId) {
        showView(viewId);
      }
    });
  });
  
  // Add any other initialization for new handlers here
  // For example, initialize supplier view handlers
  const supplierLinks = document.querySelectorAll('.supplier-link');
  supplierLinks.forEach(link => {
    link.addEventListener('click', function(e) {
      e.preventDefault();
      const supplierId = this.getAttribute('data-supplier-id');
      const supplier = roadmapData.suppliers.find(s => s.id === supplierId);
      if (supplier) {
        showSupplierDetails(supplier);
      }
    });
  });
  
  // Log that initialization is complete
  console.log('Detail handlers initialized successfully');
});

  </script>
</body>
</html>